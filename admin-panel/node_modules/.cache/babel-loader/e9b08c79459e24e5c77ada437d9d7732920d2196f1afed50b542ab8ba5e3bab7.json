{"ast":null,"code":"var _jsxFileName = \"/Users/937bb/Documents/userProject/AutoPickup/admin-panel/src/components/ProductModal.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport toast from 'react-hot-toast';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { productAPI, dictionaryAPI } from '../services/api';\nimport DictionarySelect from './DictionarySelect';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  name: yup.string().required('请输入商品名称'),\n  description: yup.string().required('请输入商品描述'),\n  category: yup.string().required('请选择商品分类'),\n  price: yup.number().positive('价格必须大于0').required('请输入价格'),\n  stock: yup.number().integer('库存必须是整数').min(0, '库存不能小于0').required('请输入库存'),\n  deliveryType: yup.string().required('请选择发货类型'),\n  deliveryTemplate: yup.string().optional(),\n  deliveryData: yup.object().optional(),\n  // 添加发货数据字段\n  tags: yup.array().of(yup.string())\n});\nconst ProductModal = ({\n  isOpen,\n  onClose,\n  product,\n  onSave\n}) => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [tags, setTags] = useState([]);\n  const [tagInput, setTagInput] = useState('');\n  const [images, setImages] = useState([]);\n  const [imagePreviewUrls, setImagePreviewUrls] = useState([]);\n  const [existingImages, setExistingImages] = useState([]);\n  const [imagesToRemove, setImagesToRemove] = useState([]);\n  const [deliveryTemplates, setDeliveryTemplates] = useState([]);\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [templateFieldValues, setTemplateFieldValues] = useState({}); // 添加这行\n\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    },\n    reset,\n    watch,\n    setValue\n  } = useForm({\n    resolver: yupResolver(schema),\n    defaultValues: {\n      name: '',\n      description: '',\n      category: '',\n      price: 0,\n      stock: 0,\n      deliveryType: '',\n      deliveryTemplate: '',\n      tags: []\n    }\n  });\n  const deliveryType = watch('deliveryType');\n\n  // 渲染模板字段的函数（移到组件内部）\n  const renderTemplateField = field => {\n    const fieldValue = templateFieldValues[field.name] || field.defaultValue || '';\n    const updateFieldValue = value => {\n      setTemplateFieldValues(prev => ({\n        ...prev,\n        [field.name]: value\n      }));\n    };\n    switch (field.type) {\n      case 'text':\n      case 'url':\n      case 'number':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: [field.label, \" \", field.required && '*']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: field.type === 'number' ? 'number' : 'text',\n            value: fieldValue,\n            onChange: e => updateFieldValue(e.target.value),\n            placeholder: field.placeholder,\n            required: field.required,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 13\n          }, this)]\n        }, field.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this);\n      case 'password':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: [field.label, \" \", field.required && '*']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"password\",\n            value: fieldValue,\n            onChange: e => updateFieldValue(e.target.value),\n            placeholder: field.placeholder,\n            required: field.required,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 13\n          }, this)]\n        }, field.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }, this);\n      case 'textarea':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: [field.label, \" \", field.required && '*']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: fieldValue,\n            onChange: e => updateFieldValue(e.target.value),\n            placeholder: field.placeholder,\n            required: field.required,\n            rows: 3,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this)]\n        }, field.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this);\n      case 'file':\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"block text-sm font-medium text-gray-700 mb-1\",\n            children: [field.label, \" \", field.required && '*']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            onChange: e => {\n              var _e$target$files;\n              const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n              if (file) {\n                updateFieldValue(file.name);\n              }\n            },\n            required: field.required,\n            className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this)]\n        }, field.name, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }, this);\n      default:\n        return null;\n    }\n  };\n\n  // 获取发货模板\n  // 在fetchDeliveryTemplates函数中添加更多调试信息\n  const fetchDeliveryTemplates = async deliveryType => {\n    try {\n      console.log('=== 获取发货模板调试 ===');\n      console.log('发货类型:', deliveryType);\n      console.log('当前产品数据:', product);\n      console.log('产品的deliveryTemplate字段:', product === null || product === void 0 ? void 0 : product.deliveryTemplate);\n      console.log('产品的deliveryTemplateCode字段:', product === null || product === void 0 ? void 0 : product.deliveryTemplateCode);\n      const response = await dictionaryAPI.getDeliveryTemplates(deliveryType);\n      console.log('模板API完整响应:', response);\n      if (response.data.success) {\n        console.log('返回的模板列表:', response.data.data);\n        console.log('模板数量:', response.data.data.length);\n\n        // 打印每个模板的templateCode\n        response.data.data.forEach((template, index) => {\n          console.log(`模板${index + 1}: ${template.templateCode} - ${template.templateName}`);\n        });\n        setDeliveryTemplates(response.data.data);\n\n        // 编辑模式：优先使用产品的现有模板 - 修复字段名\n        if (product && (product.deliveryTemplateCode || product.deliveryTemplate)) {\n          const templateCode = product.deliveryTemplateCode || product.deliveryTemplate;\n          console.log('正在查找模板代码:', templateCode);\n          const existingTemplate = response.data.data.find(t => {\n            console.log(`比较: ${t.templateCode} === ${templateCode}`);\n            return t.templateCode === templateCode;\n          });\n          console.log('找到的现有模板:', existingTemplate);\n          if (existingTemplate) {\n            console.log('设置现有模板:', existingTemplate);\n            setSelectedTemplate(existingTemplate);\n            setValue('deliveryTemplate', existingTemplate.templateCode);\n            return;\n          } else {\n            console.log('❌ 未找到匹配的模板');\n          }\n        }\n\n        // 新建模式或找不到现有模板时：使用默认模板\n        const defaultTemplate = response.data.data.find(t => t.isDefault);\n        console.log('默认模板:', defaultTemplate);\n        if (defaultTemplate) {\n          console.log('设置默认模板:', defaultTemplate);\n          setSelectedTemplate(defaultTemplate);\n          setValue('deliveryTemplate', defaultTemplate.templateCode);\n        }\n      } else {\n        console.log('❌ API响应失败:', response.data);\n      }\n    } catch (error) {\n      console.error('❌ 获取发货模板失败:', error);\n    }\n  };\n\n  // 处理发货类型变化\n  // 修复handleDeliveryTypeChange函数\n  const handleDeliveryTypeChange = (value, option) => {\n    setValue('deliveryType', value);\n    if (option) {\n      // 使用option.value而不是value，因为value可能是完整的代码\n      console.log('发货类型变化:', {\n        value,\n        option\n      });\n      fetchDeliveryTemplates(option.value || value);\n    }\n  };\n\n  // 修复useEffect中的发货类型获取\n  useEffect(() => {\n    if (product) {\n      var _product$images, _product$categoryCode, _product$deliveryType, _product$deliveryType2;\n      console.log('=== 产品数据完整调试 ===');\n      console.log('产品对象:', product);\n      console.log('deliveryTemplate字段:', product.deliveryTemplate);\n      console.log('deliveryTemplateCode字段:', product.deliveryTemplateCode);\n      console.log('deliveryTypeCode字段:', product.deliveryTypeCode);\n      console.log('deliveryType字段:', product.deliveryType);\n      console.log('完整产品数据:', product);\n      console.log('产品图片字段:', product.images);\n      console.log('图片数组类型:', Array.isArray(product.images));\n      console.log('图片数组长度:', (_product$images = product.images) === null || _product$images === void 0 ? void 0 : _product$images.length);\n\n      // 修复reset调用中的字段映射\n      reset({\n        name: product.name,\n        description: product.description,\n        category: ((_product$categoryCode = product.categoryCode) === null || _product$categoryCode === void 0 ? void 0 : _product$categoryCode.code) || product.category || '',\n        price: product.price,\n        stock: product.stock,\n        deliveryType: ((_product$deliveryType = product.deliveryTypeCode) === null || _product$deliveryType === void 0 ? void 0 : _product$deliveryType.code) || product.deliveryType || '',\n        // 修复第210-235行的deliveryTemplateCode错误\n        deliveryTemplate: product.deliveryTemplateCode || product.deliveryTemplate || '',\n        // 修复字段名\n        tags: product.tags || []\n      });\n      setTags(product.tags || []);\n\n      // 添加更详细的图片设置逻辑\n      const imageArray = product.images || [];\n      console.log('设置的图片数组:', imageArray);\n      setExistingImages(imageArray);\n\n      // 如果产品有发货数据，设置模板字段值\n      if (product.deliveryData) {\n        console.log('设置发货数据:', product.deliveryData);\n        console.log('产品模板代码:', product.deliveryTemplate); // 使用正确的属性名\n        setTemplateFieldValues(product.deliveryData);\n      }\n\n      // 如果有发货类型，获取对应的模板\n      const deliveryTypeValue = ((_product$deliveryType2 = product.deliveryTypeCode) === null || _product$deliveryType2 === void 0 ? void 0 : _product$deliveryType2.code) || product.deliveryType;\n      if (deliveryTypeValue) {\n        fetchDeliveryTemplates(deliveryTypeValue);\n      }\n    } else {\n      console.log('=== 清空产品数据 ===');\n      reset({\n        name: '',\n        description: '',\n        category: '',\n        price: 0,\n        stock: 0,\n        deliveryType: '',\n        deliveryTemplate: '',\n        tags: []\n      });\n      setTags([]);\n      setExistingImages([]);\n      setTemplateFieldValues({});\n      setSelectedTemplate(null);\n      setDeliveryTemplates([]);\n    }\n  }, [product, reset]);\n  const handleAddTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      const newTags = [...tags, tagInput.trim()];\n      setTags(newTags);\n      setValue('tags', newTags);\n      setTagInput('');\n    }\n  };\n  const handleRemoveTag = tagToRemove => {\n    const newTags = tags.filter(tag => tag !== tagToRemove);\n    setTags(newTags);\n    setValue('tags', newTags);\n  };\n  const handleImageUpload = e => {\n    const files = Array.from(e.target.files || []);\n    const totalImages = images.length + existingImages.length;\n    if (totalImages + files.length > 5) {\n      toast.error('最多只能上传5张图片');\n      return;\n    }\n    setImages(prev => [...prev, ...files]);\n    files.forEach(file => {\n      const reader = new FileReader();\n      reader.onload = e => {\n        setImagePreviewUrls(prev => {\n          var _e$target;\n          return [...prev, (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result];\n        });\n      };\n      reader.readAsDataURL(file);\n    });\n  };\n  const removeNewImage = index => {\n    setImages(prev => prev.filter((_, i) => i !== index));\n    setImagePreviewUrls(prev => prev.filter((_, i) => i !== index));\n  };\n  const removeExistingImage = index => {\n    const imageToRemove = existingImages[index];\n    setImagesToRemove(prev => [...prev, imageToRemove]);\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\n  };\n  const onSubmit = async data => {\n    try {\n      setLoading(true);\n      const formData = new FormData();\n\n      // 添加基本字段\n      Object.keys(data).forEach(key => {\n        if (key !== 'tags' && data[key] !== undefined) {\n          formData.append(key, String(data[key]));\n        }\n      });\n\n      // 添加标签\n      if (tags.length > 0) {\n        formData.append('tags', JSON.stringify(tags));\n      }\n\n      // 添加模板字段数据\n      if (selectedTemplate && Object.keys(templateFieldValues).length > 0) {\n        formData.append('deliveryData', JSON.stringify(templateFieldValues));\n      }\n\n      // 添加图片\n      images.forEach(image => {\n        formData.append('images', image);\n      });\n\n      // 添加要删除的图片\n      if (imagesToRemove.length > 0) {\n        formData.append('imagesToRemove', JSON.stringify(imagesToRemove));\n      }\n      let response;\n      if (product) {\n        response = await productAPI.updateProduct(product._id, formData);\n      } else {\n        response = await productAPI.createProduct(formData);\n      }\n      if (response.success) {\n        toast.success(product ? '商品更新成功' : '商品创建成功');\n        onSave();\n        onClose();\n      } else {\n        toast.error(response.message || '操作失败');\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('提交失败:', error);\n      toast.error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || '操作失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 shadow-lg rounded-md bg-white\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-gray-900\",\n            children: product ? '编辑商品' : '添加商品'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 404,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onClose,\n            className: \"text-gray-400 hover:text-gray-600\",\n            children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n              className: \"w-6 h-6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 407,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 403,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit(onSubmit),\n          className: \"space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u540D\\u79F0 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              ...register('name'),\n              className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.name ? 'border-red-500' : 'border-gray-300'}`,\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5546\\u54C1\\u540D\\u79F0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 15\n            }, this), errors.name && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.name.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 430,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 417,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u63CF\\u8FF0 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 436,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              ...register('description'),\n              rows: 4,\n              className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.description ? 'border-red-500' : 'border-gray-300'}`,\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5546\\u54C1\\u63CF\\u8FF0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 439,\n              columnNumber: 15\n            }, this), errors.description && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.description.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 448,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 435,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u5206\\u7C7B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(DictionarySelect, {\n              typeCode: \"PRODUCT_CATEGORY\",\n              value: watch('category'),\n              onChange: value => setValue('category', value),\n              placeholder: \"\\u8BF7\\u9009\\u62E9\\u5546\\u54C1\\u5206\\u7C7B\",\n              className: errors.category ? 'border-red-500' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 457,\n              columnNumber: 15\n            }, this), errors.category && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.category.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 465,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 453,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u53D1\\u8D27\\u7C7B\\u578B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 471,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(DictionarySelect, {\n              typeCode: \"DELIVERY_TYPE\",\n              value: watch('deliveryType'),\n              onChange: handleDeliveryTypeChange\n              // 修复第440-450行的JSX语法错误\n              ,\n              placeholder: \"\\u8BF7\\u9009\\u62E9\\u53D1\\u8D27\\u7C7B\\u578B\",\n              className: errors.deliveryType ? 'border-red-500' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 15\n            }, this), errors.deliveryType && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.deliveryType.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 483,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 470,\n            columnNumber: 13\n          }, this), \"  \", deliveryTemplates.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u53D1\\u8D27\\u6A21\\u677F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"text-xs text-gray-500 mb-2\",\n              children: [\"\\u8C03\\u8BD5\\u4FE1\\u606F: \\u6A21\\u677F\\u6570\\u91CF=\", deliveryTemplates.length, \", \\u9009\\u4E2D\\u6A21\\u677F=\", (selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.templateCode) || '无']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: (selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.templateCode) || '',\n              onChange: e => {\n                const template = deliveryTemplates.find(t => t.templateCode === e.target.value);\n                console.log('选择的模板:', template);\n                console.log('模板字段:', template === null || template === void 0 ? void 0 : template.fields);\n                setSelectedTemplate(template);\n                setValue('deliveryTemplate', e.target.value);\n                // 修复第465-470行的deliveryTemplateCode错误\n                // 只在新建模式或切换到不同模板时重置字段值\n                const currentTemplateCode = product === null || product === void 0 ? void 0 : product.deliveryTemplate; // 使用正确的属性名\n                if (!product || currentTemplateCode !== e.target.value) {\n                  setTemplateFieldValues({});\n                }\n              },\n              className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u8BF7\\u9009\\u62E9\\u53D1\\u8D27\\u6A21\\u677F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 19\n              }, this), deliveryTemplates.map(template => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: template.templateCode,\n                children: template.templateName\n              }, template.templateCode, false, {\n                fileName: _jsxFileName,\n                lineNumber: 516,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 mb-2\",\n            children: [\"\\u8C03\\u8BD5: selectedTemplate=\", selectedTemplate ? '有' : '无', \", fields=\", selectedTemplate !== null && selectedTemplate !== void 0 && selectedTemplate.fields ? selectedTemplate.fields.length : 0, \"\\u4E2A\\u5B57\\u6BB5\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 13\n          }, this), selectedTemplate && selectedTemplate.fields && selectedTemplate.fields.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-50 rounded-lg p-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-sm font-medium text-gray-700 mb-3\",\n              children: \"\\u53D1\\u8D27\\u4FE1\\u606F\\u586B\\u5199\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 531,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: selectedTemplate.fields.map(field => {\n                console.log('渲染字段:', field);\n                return renderTemplateField(field);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 532,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 530,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"\\u4EF7\\u683C *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 544,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                step: \"0.01\",\n                ...register('price', {\n                  valueAsNumber: true\n                }),\n                className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.price ? 'border-red-500' : 'border-gray-300'}`,\n                placeholder: \"0.00\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 547,\n                columnNumber: 17\n              }, this), errors.price && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-red-500 text-sm mt-1\",\n                children: errors.price.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 557,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 543,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"\\u5E93\\u5B58 *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 562,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                ...register('stock', {\n                  valueAsNumber: true\n                }),\n                className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.stock ? 'border-red-500' : 'border-gray-300'}`,\n                placeholder: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 565,\n                columnNumber: 17\n              }, this), errors.stock && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-red-500 text-sm mt-1\",\n                children: errors.stock.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 574,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 561,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 542,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u5546\\u54C1\\u56FE\\u7247 (\\u6700\\u591A5\\u5F20)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 15\n            }, this), existingImages.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-2\",\n                children: [\"\\u73B0\\u6709\\u56FE\\u7247 (\", existingImages.length, \"\\u5F20)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 588,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-3 gap-2 mb-4\",\n                children: existingImages.map((image, index) => {\n                  return /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"relative group\",\n                    children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                      src: `${process.env.REACT_APP_IMG_URL || 'http://localhost:3001'}${image}`,\n                      alt: `现有图片 ${index + 1}`,\n                      className: \"w-full h-32 object-cover rounded-lg border border-gray-200\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 596,\n                      columnNumber: 27\n                    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                      type: \"button\",\n                      onClick: () => {\n                        setExistingImages(prev => prev.filter((_, i) => i !== index));\n                        setImagesToRemove(prev => [...prev, image]);\n                      },\n                      className: \"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600\",\n                      children: \"\\xD7\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 601,\n                      columnNumber: 27\n                    }, this)]\n                  }, index, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 595,\n                    columnNumber: 25\n                  }, this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 591,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 587,\n              columnNumber: 17\n            }, this), images.length + existingImages.length < 5 && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-2\",\n                children: existingImages.length > 0 ? '新增图片' : '上传图片'\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 621,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  multiple: true,\n                  accept: \"image/*\",\n                  onChange: handleImageUpload,\n                  className: \"hidden\",\n                  id: \"image-upload\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 625,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  htmlFor: \"image-upload\",\n                  className: \"cursor-pointer flex flex-col items-center\",\n                  children: [/*#__PURE__*/_jsxDEV(PhotoIcon, {\n                    className: \"w-12 h-12 text-gray-400 mb-2\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 637,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-sm text-gray-600\",\n                    children: \"\\u70B9\\u51FB\\u9009\\u62E9\\u56FE\\u7247\\u6216\\u62D6\\u62FD\\u5230\\u6B64\\u5904\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 638,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: \"text-xs text-gray-400 mt-1\",\n                    children: [\"\\u652F\\u6301 JPG\\u3001PNG \\u683C\\u5F0F\\uFF0C\\u6700\\u591A \", 5 - images.length - existingImages.length, \" \\u5F20\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 641,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 633,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 624,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 620,\n              columnNumber: 17\n            }, this), imagePreviewUrls.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-2\",\n                children: [\"\\u65B0\\u4E0A\\u4F20\\u56FE\\u7247 (\", imagePreviewUrls.length, \"\\u5F20)\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 652,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid grid-cols-3 gap-2\",\n                children: imagePreviewUrls.map((url, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"relative group\",\n                  children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                    src: url,\n                    alt: `新图片 ${index + 1}`,\n                    className: \"w-full h-32 object-cover rounded-lg border border-gray-200\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 658,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    type: \"button\",\n                    onClick: () => removeNewImage(index),\n                    className: \"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600\",\n                    children: \"\\xD7\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 663,\n                    columnNumber: 25\n                  }, this)]\n                }, index, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 657,\n                  columnNumber: 23\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 655,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 651,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 13\n          }, this), \"  \", /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u6807\\u7B7E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 679,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-wrap gap-2 mb-2\",\n              children: tags.map((tag, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\",\n                children: [tag, /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => handleRemoveTag(tag),\n                  className: \"ml-1 text-blue-600 hover:text-blue-800\",\n                  children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n                    className: \"w-3 h-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 694,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 689,\n                  columnNumber: 21\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 684,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 682,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: tagInput,\n                onChange: e => setTagInput(e.target.value),\n                onKeyPress: e => e.key === 'Enter' && (e.preventDefault(), handleAddTag()),\n                className: \"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n                placeholder: \"\\u8F93\\u5165\\u6807\\u7B7E\\u540E\\u6309\\u56DE\\u8F66\\u6DFB\\u52A0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 700,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: handleAddTag,\n                className: \"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\",\n                children: \"\\u6DFB\\u52A0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 708,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 699,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 678,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end space-x-2 pt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: onClose,\n              className: \"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50\",\n              children: \"\\u53D6\\u6D88\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 720,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: loading,\n              className: \"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\",\n              children: loading ? '保存中...' : '保存'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 727,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 719,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 415,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 9\n      }, this), \"  \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 401,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 400,\n    columnNumber: 5\n  }, this);\n};\n_s(ProductModal, \"epWB0xTq8d6URhnmUcUsJ8lDXgg=\", false, function () {\n  return [useForm];\n});\n_c = ProductModal;\nexport default ProductModal;\nvar _c;\n$RefreshReg$(_c, \"ProductModal\");","map":{"version":3,"names":["React","useState","useEffect","useForm","yupResolver","yup","toast","PhotoIcon","XMarkIcon","productAPI","dictionaryAPI","DictionarySelect","jsxDEV","_jsxDEV","schema","object","name","string","required","description","category","price","number","positive","stock","integer","min","deliveryType","deliveryTemplate","optional","deliveryData","tags","array","of","ProductModal","isOpen","onClose","product","onSave","_s","loading","setLoading","setTags","tagInput","setTagInput","images","setImages","imagePreviewUrls","setImagePreviewUrls","existingImages","setExistingImages","imagesToRemove","setImagesToRemove","deliveryTemplates","setDeliveryTemplates","selectedTemplate","setSelectedTemplate","templateFieldValues","setTemplateFieldValues","register","handleSubmit","formState","errors","reset","watch","setValue","resolver","defaultValues","renderTemplateField","field","fieldValue","defaultValue","updateFieldValue","value","prev","type","children","className","label","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","target","placeholder","rows","_e$target$files","file","files","fetchDeliveryTemplates","console","log","deliveryTemplateCode","response","getDeliveryTemplates","data","success","length","forEach","template","index","templateCode","templateName","existingTemplate","find","t","defaultTemplate","isDefault","error","handleDeliveryTypeChange","option","_product$images","_product$categoryCode","_product$deliveryType","_product$deliveryType2","deliveryTypeCode","Array","isArray","categoryCode","code","imageArray","deliveryTypeValue","handleAddTag","trim","includes","newTags","handleRemoveTag","tagToRemove","filter","tag","handleImageUpload","from","totalImages","reader","FileReader","onload","_e$target","result","readAsDataURL","removeNewImage","_","i","removeExistingImage","imageToRemove","onSubmit","formData","FormData","Object","keys","key","undefined","append","String","JSON","stringify","image","updateProduct","_id","createProduct","message","_error$response","_error$response$data","onClick","typeCode","fields","currentTemplateCode","map","step","valueAsNumber","src","process","env","REACT_APP_IMG_URL","alt","multiple","accept","id","htmlFor","url","onKeyPress","preventDefault","disabled","_c","$RefreshReg$"],"sources":["/Users/937bb/Documents/userProject/AutoPickup/admin-panel/src/components/ProductModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport toast from 'react-hot-toast';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { productAPI, dictionaryAPI } from '../services/api';\nimport { Product, ProductFormData } from '../types';\nimport DictionarySelect from './DictionarySelect';\n\nconst schema = yup.object({\n  name: yup.string().required('请输入商品名称'),\n  description: yup.string().required('请输入商品描述'),\n  category: yup.string().required('请选择商品分类'),\n  price: yup.number().positive('价格必须大于0').required('请输入价格'),\n  stock: yup.number().integer('库存必须是整数').min(0, '库存不能小于0').required('请输入库存'),\n  deliveryType: yup.string().required('请选择发货类型'),\n  deliveryTemplate: yup.string().optional(),\n  deliveryData: yup.object().optional(), // 添加发货数据字段\n  tags: yup.array().of(yup.string()),\n});\n\ntype FormData = yup.InferType<typeof schema>;\n\ninterface ProductModalProps {\n  isOpen: boolean;\n  product?: Product | null;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nconst ProductModal: React.FC<ProductModalProps> = ({ isOpen, onClose, product, onSave }) => {\n  const [loading, setLoading] = useState(false);\n  const [tags, setTags] = useState<string[]>([]);\n  const [tagInput, setTagInput] = useState('');\n  const [images, setImages] = useState<File[]>([]);\n  const [imagePreviewUrls, setImagePreviewUrls] = useState<string[]>([]);\n  const [existingImages, setExistingImages] = useState<string[]>([]);\n  const [imagesToRemove, setImagesToRemove] = useState<string[]>([]);\n  const [deliveryTemplates, setDeliveryTemplates] = useState<any[]>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<any>(null);\n  const [templateFieldValues, setTemplateFieldValues] = useState<Record<string, any>>({}); // 添加这行\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    reset,\n    watch,\n    setValue,\n  } = useForm<FormData>({\n    resolver: yupResolver(schema),\n    defaultValues: {\n      name: '',\n      description: '',\n      category: '',\n      price: 0,\n      stock: 0,\n      deliveryType: '',\n      deliveryTemplate: '',\n      tags: [],\n    },\n  });\n\n  const deliveryType = watch('deliveryType');\n\n  // 渲染模板字段的函数（移到组件内部）\n  const renderTemplateField = (field: any) => {\n    const fieldValue = templateFieldValues[field.name] || field.defaultValue || '';\n    \n    const updateFieldValue = (value: any) => {\n      setTemplateFieldValues((prev: Record<string, any>) => ({\n        ...prev,\n        [field.name]: value\n      }));\n    };\n\n    switch (field.type) {\n      case 'text':\n      case 'url':\n      case 'number':\n        return (\n          <div key={field.name}>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {field.label} {field.required && '*'}\n            </label>\n            <input\n              type={field.type === 'number' ? 'number' : 'text'}\n              value={fieldValue}\n              onChange={(e) => updateFieldValue(e.target.value)}\n              placeholder={field.placeholder}\n              required={field.required}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        );\n      \n      case 'password':\n        return (\n          <div key={field.name}>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {field.label} {field.required && '*'}\n            </label>\n            <input\n              type=\"password\"\n              value={fieldValue}\n              onChange={(e) => updateFieldValue(e.target.value)}\n              placeholder={field.placeholder}\n              required={field.required}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        );\n      \n      case 'textarea':\n        return (\n          <div key={field.name}>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {field.label} {field.required && '*'}\n            </label>\n            <textarea\n              value={fieldValue}\n              onChange={(e) => updateFieldValue(e.target.value)}\n              placeholder={field.placeholder}\n              required={field.required}\n              rows={3}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        );\n      \n      case 'file':\n        return (\n          <div key={field.name}>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n              {field.label} {field.required && '*'}\n            </label>\n            <input\n              type=\"file\"\n              onChange={(e) => {\n                const file = e.target.files?.[0];\n                if (file) {\n                  updateFieldValue(file.name);\n                }\n              }}\n              required={field.required}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n        );\n      \n      default:\n        return null;\n    }\n  };\n\n  // 获取发货模板\n  // 在fetchDeliveryTemplates函数中添加更多调试信息\n  const fetchDeliveryTemplates = async (deliveryType: string) => {\n    try {\n      console.log('=== 获取发货模板调试 ===');\n      console.log('发货类型:', deliveryType);\n      console.log('当前产品数据:', product);\n      console.log('产品的deliveryTemplate字段:', product?.deliveryTemplate);\n      console.log('产品的deliveryTemplateCode字段:', (product as any)?.deliveryTemplateCode);\n      \n      const response = await dictionaryAPI.getDeliveryTemplates(deliveryType);\n      console.log('模板API完整响应:', response);\n      \n      if (response.data.success) {\n        console.log('返回的模板列表:', response.data.data);\n        console.log('模板数量:', response.data.data.length);\n        \n        // 打印每个模板的templateCode\n        response.data.data.forEach((template: any, index: number) => {\n          console.log(`模板${index + 1}: ${template.templateCode} - ${template.templateName}`);\n        });\n        \n        setDeliveryTemplates(response.data.data);\n        \n        // 编辑模式：优先使用产品的现有模板 - 修复字段名\n        if (product && ((product as any).deliveryTemplateCode || product.deliveryTemplate)) {\n          const templateCode = (product as any).deliveryTemplateCode || product.deliveryTemplate;\n          console.log('正在查找模板代码:', templateCode);\n          \n          const existingTemplate = response.data.data.find((t: any) => {\n            console.log(`比较: ${t.templateCode} === ${templateCode}`);\n            return t.templateCode === templateCode;\n          });\n          \n          console.log('找到的现有模板:', existingTemplate);\n          \n          if (existingTemplate) {\n            console.log('设置现有模板:', existingTemplate);\n            setSelectedTemplate(existingTemplate);\n            setValue('deliveryTemplate', existingTemplate.templateCode);\n            return;\n          } else {\n            console.log('❌ 未找到匹配的模板');\n          }\n        }\n        \n        // 新建模式或找不到现有模板时：使用默认模板\n        const defaultTemplate = response.data.data.find((t: any) => t.isDefault);\n        console.log('默认模板:', defaultTemplate);\n        if (defaultTemplate) {\n          console.log('设置默认模板:', defaultTemplate);\n          setSelectedTemplate(defaultTemplate);\n          setValue('deliveryTemplate', defaultTemplate.templateCode);\n        }\n      } else {\n        console.log('❌ API响应失败:', response.data);\n      }\n    } catch (error) {\n      console.error('❌ 获取发货模板失败:', error);\n    }\n  };\n\n  // 处理发货类型变化\n  // 修复handleDeliveryTypeChange函数\n  const handleDeliveryTypeChange = (value: string, option?: any) => {\n    setValue('deliveryType', value);\n    if (option) {\n      // 使用option.value而不是value，因为value可能是完整的代码\n      console.log('发货类型变化:', { value, option });\n      fetchDeliveryTemplates(option.value || value);\n    }\n  };\n  \n  // 修复useEffect中的发货类型获取\n  useEffect(() => {\n    if (product) {\n      console.log('=== 产品数据完整调试 ===');\n      console.log('产品对象:', product);\n      console.log('deliveryTemplate字段:', product.deliveryTemplate);\n      console.log('deliveryTemplateCode字段:', (product as any).deliveryTemplateCode);\n      console.log('deliveryTypeCode字段:', product.deliveryTypeCode);\n      console.log('deliveryType字段:', product.deliveryType);\n      \n      console.log('完整产品数据:', product);\n      console.log('产品图片字段:', product.images);\n      console.log('图片数组类型:', Array.isArray(product.images));\n      console.log('图片数组长度:', product.images?.length);\n      \n      // 修复reset调用中的字段映射\n      reset({\n        name: product.name,\n        description: product.description,\n        category: product.categoryCode?.code || product.category || '',\n        price: product.price,\n        stock: product.stock,\n        deliveryType: product.deliveryTypeCode?.code || product.deliveryType || '',\n        // 修复第210-235行的deliveryTemplateCode错误\n        deliveryTemplate: (product as any).deliveryTemplateCode || product.deliveryTemplate || '', // 修复字段名\n        tags: product.tags || [],\n        });\n        setTags(product.tags || []);\n        \n        // 添加更详细的图片设置逻辑\n        const imageArray = product.images || [];\n        console.log('设置的图片数组:', imageArray);\n        setExistingImages(imageArray);\n        \n        // 如果产品有发货数据，设置模板字段值\n        if (product.deliveryData) {\n          console.log('设置发货数据:', product.deliveryData);\n          console.log('产品模板代码:', product.deliveryTemplate); // 使用正确的属性名\n          setTemplateFieldValues(product.deliveryData);\n        }\n      \n      // 如果有发货类型，获取对应的模板\n      const deliveryTypeValue = product.deliveryTypeCode?.code || product.deliveryType;\n      if (deliveryTypeValue) {\n        fetchDeliveryTemplates(deliveryTypeValue);\n      }\n    } else {\n      console.log('=== 清空产品数据 ===');\n      reset({\n        name: '',\n        description: '',\n        category: '',\n        price: 0,\n        stock: 0,\n        deliveryType: '',\n        deliveryTemplate: '',\n        tags: [],\n      });\n      setTags([]);\n      setExistingImages([]);\n      setTemplateFieldValues({});\n      setSelectedTemplate(null);\n      setDeliveryTemplates([]);\n    }\n  }, [product, reset]);\n\n  const handleAddTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      const newTags = [...tags, tagInput.trim()];\n      setTags(newTags);\n      setValue('tags', newTags);\n      setTagInput('');\n    }\n  };\n\n  const handleRemoveTag = (tagToRemove: string) => {\n    const newTags = tags.filter(tag => tag !== tagToRemove);\n    setTags(newTags);\n    setValue('tags', newTags);\n  };\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    const totalImages = images.length + existingImages.length;\n    \n    if (totalImages + files.length > 5) {\n      toast.error('最多只能上传5张图片');\n      return;\n    }\n\n    setImages(prev => [...prev, ...files]);\n    \n    files.forEach(file => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        setImagePreviewUrls(prev => [...prev, e.target?.result as string]);\n      };\n      reader.readAsDataURL(file);\n    });\n  };\n\n  const removeNewImage = (index: number) => {\n    setImages(prev => prev.filter((_, i) => i !== index));\n    setImagePreviewUrls(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const removeExistingImage = (index: number) => {\n    const imageToRemove = existingImages[index];\n    setImagesToRemove(prev => [...prev, imageToRemove]);\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const onSubmit: SubmitHandler<FormData> = async (data) => {\n    try {\n      setLoading(true);\n      \n      const formData = new FormData();\n      \n      // 添加基本字段\n      Object.keys(data).forEach(key => {\n        if (key !== 'tags' && data[key as keyof FormData] !== undefined) {\n          formData.append(key, String(data[key as keyof FormData]));\n        }\n      });\n      \n      // 添加标签\n      if (tags.length > 0) {\n        formData.append('tags', JSON.stringify(tags));\n      }\n      \n      // 添加模板字段数据\n      if (selectedTemplate && Object.keys(templateFieldValues).length > 0) {\n        formData.append('deliveryData', JSON.stringify(templateFieldValues));\n      }\n      \n      // 添加图片\n      images.forEach((image) => {\n        formData.append('images', image);\n      });\n      \n      // 添加要删除的图片\n      if (imagesToRemove.length > 0) {\n        formData.append('imagesToRemove', JSON.stringify(imagesToRemove));\n      }\n      \n      let response;\n      if (product) {\n        response = await productAPI.updateProduct(product._id, formData);\n      } else {\n        response = await productAPI.createProduct(formData);\n      }\n      \n      if (response.success) {\n        toast.success(product ? '商品更新成功' : '商品创建成功');\n        onSave();\n        onClose();\n      } else {\n        toast.error(response.message || '操作失败');\n      }\n    } catch (error: any) {\n      console.error('提交失败:', error);\n      toast.error(error.response?.data?.message || '操作失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n      <div className=\"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 shadow-lg rounded-md bg-white\">\n        <div className=\"mt-3\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              {product ? '编辑商品' : '添加商品'}\n            </h3>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600\"\n            >\n              <XMarkIcon className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* 商品名称 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品名称 *\n              </label>\n              <input\n                type=\"text\"\n                {...register('name')}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                  errors.name ? 'border-red-500' : 'border-gray-300'\n                }`}\n                placeholder=\"请输入商品名称\"\n              />\n              {errors.name && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.name.message}</p>\n              )}\n            </div>\n\n            {/* 商品描述 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品描述 *\n              </label>\n              <textarea\n                {...register('description')}\n                rows={4}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                  errors.description ? 'border-red-500' : 'border-gray-300'\n                }`}\n                placeholder=\"请输入商品描述\"\n              />\n              {errors.description && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.description.message}</p>\n              )}\n            </div>\n\n            {/* 商品分类 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品分类 *\n              </label>\n              <DictionarySelect\n                typeCode=\"PRODUCT_CATEGORY\"\n                value={watch('category')}\n                onChange={(value) => setValue('category', value)}\n                placeholder=\"请选择商品分类\"\n                className={errors.category ? 'border-red-500' : ''}\n              />\n              {errors.category && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.category.message}</p>\n              )}\n            </div>\n\n            {/* 发货类型 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                发货类型 *\n              </label>\n              <DictionarySelect\n                typeCode=\"DELIVERY_TYPE\"\n                value={watch('deliveryType')}\n                onChange={handleDeliveryTypeChange}\n                // 修复第440-450行的JSX语法错误\n                placeholder=\"请选择发货类型\"\n                className={errors.deliveryType ? 'border-red-500' : ''}\n              />\n              {errors.deliveryType && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.deliveryType.message}</p>\n              )}\n            </div>  {/* 移除多余的 )} */}\n\n            {/* 发货模板选择 */}\n            {deliveryTemplates.length > 0 && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  发货模板\n                </label>\n                {/* 添加调试信息 */}\n                <div className=\"text-xs text-gray-500 mb-2\">\n                  调试信息: 模板数量={deliveryTemplates.length}, 选中模板={selectedTemplate?.templateCode || '无'}\n                </div>\n                <select\n                  value={selectedTemplate?.templateCode || ''}\n                  onChange={(e) => {\n                    const template = deliveryTemplates.find(t => t.templateCode === e.target.value);\n                    console.log('选择的模板:', template);\n                    console.log('模板字段:', template?.fields);\n                    setSelectedTemplate(template);\n                    setValue('deliveryTemplate', e.target.value);\n                    // 修复第465-470行的deliveryTemplateCode错误\n                    // 只在新建模式或切换到不同模板时重置字段值\n                    const currentTemplateCode = product?.deliveryTemplate; // 使用正确的属性名\n                    if (!product || (currentTemplateCode !== e.target.value)) {\n                      setTemplateFieldValues({});\n                    }\n                  }}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"\">请选择发货模板</option>\n                  {deliveryTemplates.map((template) => (\n                    <option key={template.templateCode} value={template.templateCode}>\n                      {template.templateName}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            {/* 模板字段填写区域 - 添加更多调试信息 */}\n            <div className=\"text-xs text-gray-500 mb-2\">\n              调试: selectedTemplate={selectedTemplate ? '有' : '无'}, \n              fields={selectedTemplate?.fields ? selectedTemplate.fields.length : 0}个字段\n            </div>\n            {selectedTemplate && selectedTemplate.fields && selectedTemplate.fields.length > 0 && (\n              <div className=\"bg-gray-50 rounded-lg p-4\">\n                <h4 className=\"text-sm font-medium text-gray-700 mb-3\">发货信息填写</h4>\n                <div className=\"space-y-4\">\n                  {selectedTemplate.fields.map((field: any) => {\n                    console.log('渲染字段:', field);\n                    return renderTemplateField(field);\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* 价格和库存 */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  价格 *\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  {...register('price', { valueAsNumber: true })}\n                  className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                    errors.price ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0.00\"\n                />\n                {errors.price && (\n                  <p className=\"text-red-500 text-sm mt-1\">{errors.price.message}</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  库存 *\n                </label>\n                <input\n                  type=\"number\"\n                  {...register('stock', { valueAsNumber: true })}\n                  className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                    errors.stock ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0\"\n                />\n                {errors.stock && (\n                  <p className=\"text-red-500 text-sm mt-1\">{errors.stock.message}</p>\n                )}\n              </div>\n            </div>\n\n            {/* 商品图片 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                商品图片 (最多5张)\n              </label>\n              \n              {/* 现有图片显示 */}\n              {existingImages.length > 0 && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    现有图片 ({existingImages.length}张)\n                  </label>\n                  <div className=\"grid grid-cols-3 gap-2 mb-4\">\n                    {existingImages.map((image, index) => {\n                      \n                      return (\n                        <div key={index} className=\"relative group\">\n                          <img\n                            src={`${process.env.REACT_APP_IMG_URL || 'http://localhost:3001'}${image}`}\n                            alt={`现有图片 ${index + 1}`}\n                            className=\"w-full h-32 object-cover rounded-lg border border-gray-200\"\n                          />\n                          <button\n                            type=\"button\"\n                            onClick={() => {\n                              setExistingImages(prev => prev.filter((_, i) => i !== index));\n                              setImagesToRemove(prev => [...prev, image]);\n                            }}\n                            className=\"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600\"\n                          >\n                            ×\n                          </button>\n                        </div>\n                      );\n                    })}\n                  </div>\n                </div>\n              )}\n              \n              {/* 上传新图片 */}\n              {(images.length + existingImages.length) < 5 && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {existingImages.length > 0 ? '新增图片' : '上传图片'}\n                  </label>\n                  <div className=\"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-gray-400 transition-colors\">\n                    <input\n                      type=\"file\"\n                      multiple\n                      accept=\"image/*\"\n                      onChange={handleImageUpload}\n                      className=\"hidden\"\n                      id=\"image-upload\"\n                    />\n                    <label\n                      htmlFor=\"image-upload\"\n                      className=\"cursor-pointer flex flex-col items-center\"\n                    >\n                      <PhotoIcon className=\"w-12 h-12 text-gray-400 mb-2\" />\n                      <span className=\"text-sm text-gray-600\">\n                        点击选择图片或拖拽到此处\n                      </span>\n                      <span className=\"text-xs text-gray-400 mt-1\">\n                        支持 JPG、PNG 格式，最多 {5 - images.length - existingImages.length} 张\n                      </span>\n                    </label>\n                  </div>\n                </div>\n              )}\n\n              {/* 新上传图片预览 */}\n              {imagePreviewUrls.length > 0 && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    新上传图片 ({imagePreviewUrls.length}张)\n                  </label>\n                  <div className=\"grid grid-cols-3 gap-2\">\n                    {imagePreviewUrls.map((url, index) => (\n                      <div key={index} className=\"relative group\">\n                        <img\n                          src={url}\n                          alt={`新图片 ${index + 1}`}\n                          className=\"w-full h-32 object-cover rounded-lg border border-gray-200\"\n                        />\n                        <button\n                          type=\"button\"\n                          onClick={() => removeNewImage(index)}\n                          className=\"absolute top-2 right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600\"\n                        >\n                          ×\n                        </button>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>  {/* 添加这个闭合标签来闭合商品图片部分 */}\n\n            {/* 标签 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品标签\n              </label>\n              <div className=\"flex flex-wrap gap-2 mb-2\">\n                {tags.map((tag, index) => (\n                  <span\n                    key={index}\n                    className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\"\n                  >\n                    {tag}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveTag(tag)}\n                      className=\"ml-1 text-blue-600 hover:text-blue-800\"\n                    >\n                      <XMarkIcon className=\"w-3 h-3\" />\n                    </button>\n                  </span>\n                ))}\n              </div>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  value={tagInput}\n                  onChange={(e) => setTagInput(e.target.value)}\n                  onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddTag())}\n                  className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"输入标签后按回车添加\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={handleAddTag}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n                >\n                  添加\n                </button>\n              </div>\n            </div>\n\n            {/* Submit buttons */}\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50\"\n              >\n                取消\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\"\n              >\n                {loading ? '保存中...' : '保存'}\n              </button>\n            </div>\n          </form>\n        </div>  {/* Add this closing div tag for the mt-3 div */}\n      </div>\n    </div>\n  );\n};\n\nexport default ProductModal;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAqB,OAAO;AAC/D,SAASC,OAAO,QAAuB,iBAAiB;AACxD,SAASC,WAAW,QAAQ,yBAAyB;AACrD,OAAO,KAAKC,GAAG,MAAM,KAAK;AAC1B,OAAOC,KAAK,MAAM,iBAAiB;AACnC,SAASC,SAAS,EAAEC,SAAS,QAAQ,6BAA6B;AAClE,SAASC,UAAU,EAAEC,aAAa,QAAQ,iBAAiB;AAE3D,OAAOC,gBAAgB,MAAM,oBAAoB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAElD,MAAMC,MAAM,GAAGT,GAAG,CAACU,MAAM,CAAC;EACxBC,IAAI,EAAEX,GAAG,CAACY,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,SAAS,CAAC;EACtCC,WAAW,EAAEd,GAAG,CAACY,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,SAAS,CAAC;EAC7CE,QAAQ,EAAEf,GAAG,CAACY,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,SAAS,CAAC;EAC1CG,KAAK,EAAEhB,GAAG,CAACiB,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,SAAS,CAAC,CAACL,QAAQ,CAAC,OAAO,CAAC;EACzDM,KAAK,EAAEnB,GAAG,CAACiB,MAAM,CAAC,CAAC,CAACG,OAAO,CAAC,SAAS,CAAC,CAACC,GAAG,CAAC,CAAC,EAAE,SAAS,CAAC,CAACR,QAAQ,CAAC,OAAO,CAAC;EAC1ES,YAAY,EAAEtB,GAAG,CAACY,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,SAAS,CAAC;EAC9CU,gBAAgB,EAAEvB,GAAG,CAACY,MAAM,CAAC,CAAC,CAACY,QAAQ,CAAC,CAAC;EACzCC,YAAY,EAAEzB,GAAG,CAACU,MAAM,CAAC,CAAC,CAACc,QAAQ,CAAC,CAAC;EAAE;EACvCE,IAAI,EAAE1B,GAAG,CAAC2B,KAAK,CAAC,CAAC,CAACC,EAAE,CAAC5B,GAAG,CAACY,MAAM,CAAC,CAAC;AACnC,CAAC,CAAC;AAWF,MAAMiB,YAAyC,GAAGA,CAAC;EAAEC,MAAM;EAAEC,OAAO;EAAEC,OAAO;EAAEC;AAAO,CAAC,KAAK;EAAAC,EAAA;EAC1F,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGxC,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAM,CAAC8B,IAAI,EAAEW,OAAO,CAAC,GAAGzC,QAAQ,CAAW,EAAE,CAAC;EAC9C,MAAM,CAAC0C,QAAQ,EAAEC,WAAW,CAAC,GAAG3C,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC4C,MAAM,EAAEC,SAAS,CAAC,GAAG7C,QAAQ,CAAS,EAAE,CAAC;EAChD,MAAM,CAAC8C,gBAAgB,EAAEC,mBAAmB,CAAC,GAAG/C,QAAQ,CAAW,EAAE,CAAC;EACtE,MAAM,CAACgD,cAAc,EAAEC,iBAAiB,CAAC,GAAGjD,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAACkD,cAAc,EAAEC,iBAAiB,CAAC,GAAGnD,QAAQ,CAAW,EAAE,CAAC;EAClE,MAAM,CAACoD,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGrD,QAAQ,CAAQ,EAAE,CAAC;EACrE,MAAM,CAACsD,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGvD,QAAQ,CAAM,IAAI,CAAC;EACnE,MAAM,CAACwD,mBAAmB,EAAEC,sBAAsB,CAAC,GAAGzD,QAAQ,CAAsB,CAAC,CAAC,CAAC,CAAC,CAAC;;EAEzF,MAAM;IACJ0D,QAAQ;IACRC,YAAY;IACZC,SAAS,EAAE;MAAEC;IAAO,CAAC;IACrBC,KAAK;IACLC,KAAK;IACLC;EACF,CAAC,GAAG9D,OAAO,CAAW;IACpB+D,QAAQ,EAAE9D,WAAW,CAACU,MAAM,CAAC;IAC7BqD,aAAa,EAAE;MACbnD,IAAI,EAAE,EAAE;MACRG,WAAW,EAAE,EAAE;MACfC,QAAQ,EAAE,EAAE;MACZC,KAAK,EAAE,CAAC;MACRG,KAAK,EAAE,CAAC;MACRG,YAAY,EAAE,EAAE;MAChBC,gBAAgB,EAAE,EAAE;MACpBG,IAAI,EAAE;IACR;EACF,CAAC,CAAC;EAEF,MAAMJ,YAAY,GAAGqC,KAAK,CAAC,cAAc,CAAC;;EAE1C;EACA,MAAMI,mBAAmB,GAAIC,KAAU,IAAK;IAC1C,MAAMC,UAAU,GAAGb,mBAAmB,CAACY,KAAK,CAACrD,IAAI,CAAC,IAAIqD,KAAK,CAACE,YAAY,IAAI,EAAE;IAE9E,MAAMC,gBAAgB,GAAIC,KAAU,IAAK;MACvCf,sBAAsB,CAAEgB,IAAyB,KAAM;QACrD,GAAGA,IAAI;QACP,CAACL,KAAK,CAACrD,IAAI,GAAGyD;MAChB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,QAAQJ,KAAK,CAACM,IAAI;MAChB,KAAK,MAAM;MACX,KAAK,KAAK;MACV,KAAK,QAAQ;QACX,oBACE9D,OAAA;UAAA+D,QAAA,gBACE/D,OAAA;YAAOgE,SAAS,EAAC,8CAA8C;YAAAD,QAAA,GAC5DP,KAAK,CAACS,KAAK,EAAC,GAAC,EAACT,KAAK,CAACnD,QAAQ,IAAI,GAAG;UAAA;YAAA6D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/B,CAAC,eACRrE,OAAA;YACE8D,IAAI,EAAEN,KAAK,CAACM,IAAI,KAAK,QAAQ,GAAG,QAAQ,GAAG,MAAO;YAClDF,KAAK,EAAEH,UAAW;YAClBa,QAAQ,EAAGC,CAAC,IAAKZ,gBAAgB,CAACY,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAE;YAClDa,WAAW,EAAEjB,KAAK,CAACiB,WAAY;YAC/BpE,QAAQ,EAAEmD,KAAK,CAACnD,QAAS;YACzB2D,SAAS,EAAC;UAAwG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnH,CAAC;QAAA,GAXMb,KAAK,CAACrD,IAAI;UAAA+D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAYf,CAAC;MAGV,KAAK,UAAU;QACb,oBACErE,OAAA;UAAA+D,QAAA,gBACE/D,OAAA;YAAOgE,SAAS,EAAC,8CAA8C;YAAAD,QAAA,GAC5DP,KAAK,CAACS,KAAK,EAAC,GAAC,EAACT,KAAK,CAACnD,QAAQ,IAAI,GAAG;UAAA;YAAA6D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/B,CAAC,eACRrE,OAAA;YACE8D,IAAI,EAAC,UAAU;YACfF,KAAK,EAAEH,UAAW;YAClBa,QAAQ,EAAGC,CAAC,IAAKZ,gBAAgB,CAACY,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAE;YAClDa,WAAW,EAAEjB,KAAK,CAACiB,WAAY;YAC/BpE,QAAQ,EAAEmD,KAAK,CAACnD,QAAS;YACzB2D,SAAS,EAAC;UAAwG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnH,CAAC;QAAA,GAXMb,KAAK,CAACrD,IAAI;UAAA+D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAYf,CAAC;MAGV,KAAK,UAAU;QACb,oBACErE,OAAA;UAAA+D,QAAA,gBACE/D,OAAA;YAAOgE,SAAS,EAAC,8CAA8C;YAAAD,QAAA,GAC5DP,KAAK,CAACS,KAAK,EAAC,GAAC,EAACT,KAAK,CAACnD,QAAQ,IAAI,GAAG;UAAA;YAAA6D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/B,CAAC,eACRrE,OAAA;YACE4D,KAAK,EAAEH,UAAW;YAClBa,QAAQ,EAAGC,CAAC,IAAKZ,gBAAgB,CAACY,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAE;YAClDa,WAAW,EAAEjB,KAAK,CAACiB,WAAY;YAC/BpE,QAAQ,EAAEmD,KAAK,CAACnD,QAAS;YACzBqE,IAAI,EAAE,CAAE;YACRV,SAAS,EAAC;UAAwG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnH,CAAC;QAAA,GAXMb,KAAK,CAACrD,IAAI;UAAA+D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAYf,CAAC;MAGV,KAAK,MAAM;QACT,oBACErE,OAAA;UAAA+D,QAAA,gBACE/D,OAAA;YAAOgE,SAAS,EAAC,8CAA8C;YAAAD,QAAA,GAC5DP,KAAK,CAACS,KAAK,EAAC,GAAC,EAACT,KAAK,CAACnD,QAAQ,IAAI,GAAG;UAAA;YAAA6D,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC/B,CAAC,eACRrE,OAAA;YACE8D,IAAI,EAAC,MAAM;YACXQ,QAAQ,EAAGC,CAAC,IAAK;cAAA,IAAAI,eAAA;cACf,MAAMC,IAAI,IAAAD,eAAA,GAAGJ,CAAC,CAACC,MAAM,CAACK,KAAK,cAAAF,eAAA,uBAAdA,eAAA,CAAiB,CAAC,CAAC;cAChC,IAAIC,IAAI,EAAE;gBACRjB,gBAAgB,CAACiB,IAAI,CAACzE,IAAI,CAAC;cAC7B;YACF,CAAE;YACFE,QAAQ,EAAEmD,KAAK,CAACnD,QAAS;YACzB2D,SAAS,EAAC;UAAwG;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACnH,CAAC;QAAA,GAdMb,KAAK,CAACrD,IAAI;UAAA+D,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAef,CAAC;MAGV;QACE,OAAO,IAAI;IACf;EACF,CAAC;;EAED;EACA;EACA,MAAMS,sBAAsB,GAAG,MAAOhE,YAAoB,IAAK;IAC7D,IAAI;MACFiE,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;MAC/BD,OAAO,CAACC,GAAG,CAAC,OAAO,EAAElE,YAAY,CAAC;MAClCiE,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExD,OAAO,CAAC;MAC/BuD,OAAO,CAACC,GAAG,CAAC,wBAAwB,EAAExD,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAET,gBAAgB,CAAC;MAChEgE,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAGxD,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAUyD,oBAAoB,CAAC;MAEjF,MAAMC,QAAQ,GAAG,MAAMrF,aAAa,CAACsF,oBAAoB,CAACrE,YAAY,CAAC;MACvEiE,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEE,QAAQ,CAAC;MAEnC,IAAIA,QAAQ,CAACE,IAAI,CAACC,OAAO,EAAE;QACzBN,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEE,QAAQ,CAACE,IAAI,CAACA,IAAI,CAAC;QAC3CL,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEE,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACE,MAAM,CAAC;;QAE/C;QACAJ,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACG,OAAO,CAAC,CAACC,QAAa,EAAEC,KAAa,KAAK;UAC3DV,OAAO,CAACC,GAAG,CAAC,KAAKS,KAAK,GAAG,CAAC,KAAKD,QAAQ,CAACE,YAAY,MAAMF,QAAQ,CAACG,YAAY,EAAE,CAAC;QACpF,CAAC,CAAC;QAEFlD,oBAAoB,CAACyC,QAAQ,CAACE,IAAI,CAACA,IAAI,CAAC;;QAExC;QACA,IAAI5D,OAAO,KAAMA,OAAO,CAASyD,oBAAoB,IAAIzD,OAAO,CAACT,gBAAgB,CAAC,EAAE;UAClF,MAAM2E,YAAY,GAAIlE,OAAO,CAASyD,oBAAoB,IAAIzD,OAAO,CAACT,gBAAgB;UACtFgE,OAAO,CAACC,GAAG,CAAC,WAAW,EAAEU,YAAY,CAAC;UAEtC,MAAME,gBAAgB,GAAGV,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACS,IAAI,CAAEC,CAAM,IAAK;YAC3Df,OAAO,CAACC,GAAG,CAAC,OAAOc,CAAC,CAACJ,YAAY,QAAQA,YAAY,EAAE,CAAC;YACxD,OAAOI,CAAC,CAACJ,YAAY,KAAKA,YAAY;UACxC,CAAC,CAAC;UAEFX,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEY,gBAAgB,CAAC;UAEzC,IAAIA,gBAAgB,EAAE;YACpBb,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEY,gBAAgB,CAAC;YACxCjD,mBAAmB,CAACiD,gBAAgB,CAAC;YACrCxC,QAAQ,CAAC,kBAAkB,EAAEwC,gBAAgB,CAACF,YAAY,CAAC;YAC3D;UACF,CAAC,MAAM;YACLX,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC;UAC3B;QACF;;QAEA;QACA,MAAMe,eAAe,GAAGb,QAAQ,CAACE,IAAI,CAACA,IAAI,CAACS,IAAI,CAAEC,CAAM,IAAKA,CAAC,CAACE,SAAS,CAAC;QACxEjB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEe,eAAe,CAAC;QACrC,IAAIA,eAAe,EAAE;UACnBhB,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEe,eAAe,CAAC;UACvCpD,mBAAmB,CAACoD,eAAe,CAAC;UACpC3C,QAAQ,CAAC,kBAAkB,EAAE2C,eAAe,CAACL,YAAY,CAAC;QAC5D;MACF,CAAC,MAAM;QACLX,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEE,QAAQ,CAACE,IAAI,CAAC;MAC1C;IACF,CAAC,CAAC,OAAOa,KAAK,EAAE;MACdlB,OAAO,CAACkB,KAAK,CAAC,aAAa,EAAEA,KAAK,CAAC;IACrC;EACF,CAAC;;EAED;EACA;EACA,MAAMC,wBAAwB,GAAGA,CAACtC,KAAa,EAAEuC,MAAY,KAAK;IAChE/C,QAAQ,CAAC,cAAc,EAAEQ,KAAK,CAAC;IAC/B,IAAIuC,MAAM,EAAE;MACV;MACApB,OAAO,CAACC,GAAG,CAAC,SAAS,EAAE;QAAEpB,KAAK;QAAEuC;MAAO,CAAC,CAAC;MACzCrB,sBAAsB,CAACqB,MAAM,CAACvC,KAAK,IAAIA,KAAK,CAAC;IAC/C;EACF,CAAC;;EAED;EACAvE,SAAS,CAAC,MAAM;IACd,IAAImC,OAAO,EAAE;MAAA,IAAA4E,eAAA,EAAAC,qBAAA,EAAAC,qBAAA,EAAAC,sBAAA;MACXxB,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;MAC/BD,OAAO,CAACC,GAAG,CAAC,OAAO,EAAExD,OAAO,CAAC;MAC7BuD,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAExD,OAAO,CAACT,gBAAgB,CAAC;MAC5DgE,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAGxD,OAAO,CAASyD,oBAAoB,CAAC;MAC7EF,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAExD,OAAO,CAACgF,gBAAgB,CAAC;MAC5DzB,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAExD,OAAO,CAACV,YAAY,CAAC;MAEpDiE,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExD,OAAO,CAAC;MAC/BuD,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExD,OAAO,CAACQ,MAAM,CAAC;MACtC+C,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEyB,KAAK,CAACC,OAAO,CAAClF,OAAO,CAACQ,MAAM,CAAC,CAAC;MACrD+C,OAAO,CAACC,GAAG,CAAC,SAAS,GAAAoB,eAAA,GAAE5E,OAAO,CAACQ,MAAM,cAAAoE,eAAA,uBAAdA,eAAA,CAAgBd,MAAM,CAAC;;MAE9C;MACApC,KAAK,CAAC;QACJ/C,IAAI,EAAEqB,OAAO,CAACrB,IAAI;QAClBG,WAAW,EAAEkB,OAAO,CAAClB,WAAW;QAChCC,QAAQ,EAAE,EAAA8F,qBAAA,GAAA7E,OAAO,CAACmF,YAAY,cAAAN,qBAAA,uBAApBA,qBAAA,CAAsBO,IAAI,KAAIpF,OAAO,CAACjB,QAAQ,IAAI,EAAE;QAC9DC,KAAK,EAAEgB,OAAO,CAAChB,KAAK;QACpBG,KAAK,EAAEa,OAAO,CAACb,KAAK;QACpBG,YAAY,EAAE,EAAAwF,qBAAA,GAAA9E,OAAO,CAACgF,gBAAgB,cAAAF,qBAAA,uBAAxBA,qBAAA,CAA0BM,IAAI,KAAIpF,OAAO,CAACV,YAAY,IAAI,EAAE;QAC1E;QACAC,gBAAgB,EAAGS,OAAO,CAASyD,oBAAoB,IAAIzD,OAAO,CAACT,gBAAgB,IAAI,EAAE;QAAE;QAC3FG,IAAI,EAAEM,OAAO,CAACN,IAAI,IAAI;MACtB,CAAC,CAAC;MACFW,OAAO,CAACL,OAAO,CAACN,IAAI,IAAI,EAAE,CAAC;;MAE3B;MACA,MAAM2F,UAAU,GAAGrF,OAAO,CAACQ,MAAM,IAAI,EAAE;MACvC+C,OAAO,CAACC,GAAG,CAAC,UAAU,EAAE6B,UAAU,CAAC;MACnCxE,iBAAiB,CAACwE,UAAU,CAAC;;MAE7B;MACA,IAAIrF,OAAO,CAACP,YAAY,EAAE;QACxB8D,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExD,OAAO,CAACP,YAAY,CAAC;QAC5C8D,OAAO,CAACC,GAAG,CAAC,SAAS,EAAExD,OAAO,CAACT,gBAAgB,CAAC,CAAC,CAAC;QAClD8B,sBAAsB,CAACrB,OAAO,CAACP,YAAY,CAAC;MAC9C;;MAEF;MACA,MAAM6F,iBAAiB,GAAG,EAAAP,sBAAA,GAAA/E,OAAO,CAACgF,gBAAgB,cAAAD,sBAAA,uBAAxBA,sBAAA,CAA0BK,IAAI,KAAIpF,OAAO,CAACV,YAAY;MAChF,IAAIgG,iBAAiB,EAAE;QACrBhC,sBAAsB,CAACgC,iBAAiB,CAAC;MAC3C;IACF,CAAC,MAAM;MACL/B,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAC;MAC7B9B,KAAK,CAAC;QACJ/C,IAAI,EAAE,EAAE;QACRG,WAAW,EAAE,EAAE;QACfC,QAAQ,EAAE,EAAE;QACZC,KAAK,EAAE,CAAC;QACRG,KAAK,EAAE,CAAC;QACRG,YAAY,EAAE,EAAE;QAChBC,gBAAgB,EAAE,EAAE;QACpBG,IAAI,EAAE;MACR,CAAC,CAAC;MACFW,OAAO,CAAC,EAAE,CAAC;MACXQ,iBAAiB,CAAC,EAAE,CAAC;MACrBQ,sBAAsB,CAAC,CAAC,CAAC,CAAC;MAC1BF,mBAAmB,CAAC,IAAI,CAAC;MACzBF,oBAAoB,CAAC,EAAE,CAAC;IAC1B;EACF,CAAC,EAAE,CAACjB,OAAO,EAAE0B,KAAK,CAAC,CAAC;EAEpB,MAAM6D,YAAY,GAAGA,CAAA,KAAM;IACzB,IAAIjF,QAAQ,CAACkF,IAAI,CAAC,CAAC,IAAI,CAAC9F,IAAI,CAAC+F,QAAQ,CAACnF,QAAQ,CAACkF,IAAI,CAAC,CAAC,CAAC,EAAE;MACtD,MAAME,OAAO,GAAG,CAAC,GAAGhG,IAAI,EAAEY,QAAQ,CAACkF,IAAI,CAAC,CAAC,CAAC;MAC1CnF,OAAO,CAACqF,OAAO,CAAC;MAChB9D,QAAQ,CAAC,MAAM,EAAE8D,OAAO,CAAC;MACzBnF,WAAW,CAAC,EAAE,CAAC;IACjB;EACF,CAAC;EAED,MAAMoF,eAAe,GAAIC,WAAmB,IAAK;IAC/C,MAAMF,OAAO,GAAGhG,IAAI,CAACmG,MAAM,CAACC,GAAG,IAAIA,GAAG,KAAKF,WAAW,CAAC;IACvDvF,OAAO,CAACqF,OAAO,CAAC;IAChB9D,QAAQ,CAAC,MAAM,EAAE8D,OAAO,CAAC;EAC3B,CAAC;EAED,MAAMK,iBAAiB,GAAIhD,CAAsC,IAAK;IACpE,MAAMM,KAAK,GAAG4B,KAAK,CAACe,IAAI,CAACjD,CAAC,CAACC,MAAM,CAACK,KAAK,IAAI,EAAE,CAAC;IAC9C,MAAM4C,WAAW,GAAGzF,MAAM,CAACsD,MAAM,GAAGlD,cAAc,CAACkD,MAAM;IAEzD,IAAImC,WAAW,GAAG5C,KAAK,CAACS,MAAM,GAAG,CAAC,EAAE;MAClC7F,KAAK,CAACwG,KAAK,CAAC,YAAY,CAAC;MACzB;IACF;IAEAhE,SAAS,CAAC4B,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE,GAAGgB,KAAK,CAAC,CAAC;IAEtCA,KAAK,CAACU,OAAO,CAACX,IAAI,IAAI;MACpB,MAAM8C,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAC/BD,MAAM,CAACE,MAAM,GAAIrD,CAAC,IAAK;QACrBpC,mBAAmB,CAAC0B,IAAI;UAAA,IAAAgE,SAAA;UAAA,OAAI,CAAC,GAAGhE,IAAI,GAAAgE,SAAA,GAAEtD,CAAC,CAACC,MAAM,cAAAqD,SAAA,uBAARA,SAAA,CAAUC,MAAM,CAAW;QAAA,EAAC;MACpE,CAAC;MACDJ,MAAM,CAACK,aAAa,CAACnD,IAAI,CAAC;IAC5B,CAAC,CAAC;EACJ,CAAC;EAED,MAAMoD,cAAc,GAAIvC,KAAa,IAAK;IACxCxD,SAAS,CAAC4B,IAAI,IAAIA,IAAI,CAACwD,MAAM,CAAC,CAACY,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKzC,KAAK,CAAC,CAAC;IACrDtD,mBAAmB,CAAC0B,IAAI,IAAIA,IAAI,CAACwD,MAAM,CAAC,CAACY,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKzC,KAAK,CAAC,CAAC;EACjE,CAAC;EAED,MAAM0C,mBAAmB,GAAI1C,KAAa,IAAK;IAC7C,MAAM2C,aAAa,GAAGhG,cAAc,CAACqD,KAAK,CAAC;IAC3ClD,iBAAiB,CAACsB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEuE,aAAa,CAAC,CAAC;IACnD/F,iBAAiB,CAACwB,IAAI,IAAIA,IAAI,CAACwD,MAAM,CAAC,CAACY,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKzC,KAAK,CAAC,CAAC;EAC/D,CAAC;EAED,MAAM4C,QAAiC,GAAG,MAAOjD,IAAI,IAAK;IACxD,IAAI;MACFxD,UAAU,CAAC,IAAI,CAAC;MAEhB,MAAM0G,QAAQ,GAAG,IAAIC,QAAQ,CAAC,CAAC;;MAE/B;MACAC,MAAM,CAACC,IAAI,CAACrD,IAAI,CAAC,CAACG,OAAO,CAACmD,GAAG,IAAI;QAC/B,IAAIA,GAAG,KAAK,MAAM,IAAItD,IAAI,CAACsD,GAAG,CAAmB,KAAKC,SAAS,EAAE;UAC/DL,QAAQ,CAACM,MAAM,CAACF,GAAG,EAAEG,MAAM,CAACzD,IAAI,CAACsD,GAAG,CAAmB,CAAC,CAAC;QAC3D;MACF,CAAC,CAAC;;MAEF;MACA,IAAIxH,IAAI,CAACoE,MAAM,GAAG,CAAC,EAAE;QACnBgD,QAAQ,CAACM,MAAM,CAAC,MAAM,EAAEE,IAAI,CAACC,SAAS,CAAC7H,IAAI,CAAC,CAAC;MAC/C;;MAEA;MACA,IAAIwB,gBAAgB,IAAI8F,MAAM,CAACC,IAAI,CAAC7F,mBAAmB,CAAC,CAAC0C,MAAM,GAAG,CAAC,EAAE;QACnEgD,QAAQ,CAACM,MAAM,CAAC,cAAc,EAAEE,IAAI,CAACC,SAAS,CAACnG,mBAAmB,CAAC,CAAC;MACtE;;MAEA;MACAZ,MAAM,CAACuD,OAAO,CAAEyD,KAAK,IAAK;QACxBV,QAAQ,CAACM,MAAM,CAAC,QAAQ,EAAEI,KAAK,CAAC;MAClC,CAAC,CAAC;;MAEF;MACA,IAAI1G,cAAc,CAACgD,MAAM,GAAG,CAAC,EAAE;QAC7BgD,QAAQ,CAACM,MAAM,CAAC,gBAAgB,EAAEE,IAAI,CAACC,SAAS,CAACzG,cAAc,CAAC,CAAC;MACnE;MAEA,IAAI4C,QAAQ;MACZ,IAAI1D,OAAO,EAAE;QACX0D,QAAQ,GAAG,MAAMtF,UAAU,CAACqJ,aAAa,CAACzH,OAAO,CAAC0H,GAAG,EAAEZ,QAAQ,CAAC;MAClE,CAAC,MAAM;QACLpD,QAAQ,GAAG,MAAMtF,UAAU,CAACuJ,aAAa,CAACb,QAAQ,CAAC;MACrD;MAEA,IAAIpD,QAAQ,CAACG,OAAO,EAAE;QACpB5F,KAAK,CAAC4F,OAAO,CAAC7D,OAAO,GAAG,QAAQ,GAAG,QAAQ,CAAC;QAC5CC,MAAM,CAAC,CAAC;QACRF,OAAO,CAAC,CAAC;MACX,CAAC,MAAM;QACL9B,KAAK,CAACwG,KAAK,CAACf,QAAQ,CAACkE,OAAO,IAAI,MAAM,CAAC;MACzC;IACF,CAAC,CAAC,OAAOnD,KAAU,EAAE;MAAA,IAAAoD,eAAA,EAAAC,oBAAA;MACnBvE,OAAO,CAACkB,KAAK,CAAC,OAAO,EAAEA,KAAK,CAAC;MAC7BxG,KAAK,CAACwG,KAAK,CAAC,EAAAoD,eAAA,GAAApD,KAAK,CAACf,QAAQ,cAAAmE,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBjE,IAAI,cAAAkE,oBAAA,uBAApBA,oBAAA,CAAsBF,OAAO,KAAI,MAAM,CAAC;IACtD,CAAC,SAAS;MACRxH,UAAU,CAAC,KAAK,CAAC;IACnB;EACF,CAAC;EAED,IAAI,CAACN,MAAM,EAAE,OAAO,IAAI;EAExB,oBACEtB,OAAA;IAAKgE,SAAS,EAAC,4EAA4E;IAAAD,QAAA,eACzF/D,OAAA;MAAKgE,SAAS,EAAC,qGAAqG;MAAAD,QAAA,gBAClH/D,OAAA;QAAKgE,SAAS,EAAC,MAAM;QAAAD,QAAA,gBACnB/D,OAAA;UAAKgE,SAAS,EAAC,wCAAwC;UAAAD,QAAA,gBACrD/D,OAAA;YAAIgE,SAAS,EAAC,mCAAmC;YAAAD,QAAA,EAC9CvC,OAAO,GAAG,MAAM,GAAG;UAAM;YAAA0C,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACxB,CAAC,eACLrE,OAAA;YACEuJ,OAAO,EAAEhI,OAAQ;YACjByC,SAAS,EAAC,mCAAmC;YAAAD,QAAA,eAE7C/D,OAAA,CAACL,SAAS;cAACqE,SAAS,EAAC;YAAS;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAE;UAAC;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC3B,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACN,CAAC,eAENrE,OAAA;UAAMqI,QAAQ,EAAEtF,YAAY,CAACsF,QAAQ,CAAE;UAACrE,SAAS,EAAC,WAAW;UAAAD,QAAA,gBAE3D/D,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrE,OAAA;cACE8D,IAAI,EAAC,MAAM;cAAA,GACPhB,QAAQ,CAAC,MAAM,CAAC;cACpBkB,SAAS,EAAE,0FACTf,MAAM,CAAC9C,IAAI,GAAG,gBAAgB,GAAG,iBAAiB,EACjD;cACHsE,WAAW,EAAC;YAAS;cAAAP,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACtB,CAAC,EACDpB,MAAM,CAAC9C,IAAI,iBACVH,OAAA;cAAGgE,SAAS,EAAC,2BAA2B;cAAAD,QAAA,EAAEd,MAAM,CAAC9C,IAAI,CAACiJ;YAAO;cAAAlF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAClE;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eAGNrE,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrE,OAAA;cAAA,GACM8C,QAAQ,CAAC,aAAa,CAAC;cAC3B4B,IAAI,EAAE,CAAE;cACRV,SAAS,EAAE,0FACTf,MAAM,CAAC3C,WAAW,GAAG,gBAAgB,GAAG,iBAAiB,EACxD;cACHmE,WAAW,EAAC;YAAS;cAAAP,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACtB,CAAC,EACDpB,MAAM,CAAC3C,WAAW,iBACjBN,OAAA;cAAGgE,SAAS,EAAC,2BAA2B;cAAAD,QAAA,EAAEd,MAAM,CAAC3C,WAAW,CAAC8I;YAAO;cAAAlF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CACzE;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eAGNrE,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrE,OAAA,CAACF,gBAAgB;cACf0J,QAAQ,EAAC,kBAAkB;cAC3B5F,KAAK,EAAET,KAAK,CAAC,UAAU,CAAE;cACzBmB,QAAQ,EAAGV,KAAK,IAAKR,QAAQ,CAAC,UAAU,EAAEQ,KAAK,CAAE;cACjDa,WAAW,EAAC,4CAAS;cACrBT,SAAS,EAAEf,MAAM,CAAC1C,QAAQ,GAAG,gBAAgB,GAAG;YAAG;cAAA2D,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpD,CAAC,EACDpB,MAAM,CAAC1C,QAAQ,iBACdP,OAAA;cAAGgE,SAAS,EAAC,2BAA2B;cAAAD,QAAA,EAAEd,MAAM,CAAC1C,QAAQ,CAAC6I;YAAO;cAAAlF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CACtE;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,eAGNrE,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrE,OAAA,CAACF,gBAAgB;cACf0J,QAAQ,EAAC,eAAe;cACxB5F,KAAK,EAAET,KAAK,CAAC,cAAc,CAAE;cAC7BmB,QAAQ,EAAE4B;cACV;cAAA;cACAzB,WAAW,EAAC,4CAAS;cACrBT,SAAS,EAAEf,MAAM,CAACnC,YAAY,GAAG,gBAAgB,GAAG;YAAG;cAAAoD,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACxD,CAAC,EACDpB,MAAM,CAACnC,YAAY,iBAClBd,OAAA;cAAGgE,SAAS,EAAC,2BAA2B;cAAAD,QAAA,EAAEd,MAAM,CAACnC,YAAY,CAACsI;YAAO;cAAAlF,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAC1E;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,MAAE,EAGP7B,iBAAiB,CAAC8C,MAAM,GAAG,CAAC,iBAC3BtF,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eAERrE,OAAA;cAAKgE,SAAS,EAAC,4BAA4B;cAAAD,QAAA,GAAC,qDAC/B,EAACvB,iBAAiB,CAAC8C,MAAM,EAAC,6BAAO,EAAC,CAAA5C,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAEgD,YAAY,KAAI,GAAG;YAAA;cAAAxB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAC/E,CAAC,eACNrE,OAAA;cACE4D,KAAK,EAAE,CAAAlB,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAEgD,YAAY,KAAI,EAAG;cAC5CpB,QAAQ,EAAGC,CAAC,IAAK;gBACf,MAAMiB,QAAQ,GAAGhD,iBAAiB,CAACqD,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACJ,YAAY,KAAKnB,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAC;gBAC/EmB,OAAO,CAACC,GAAG,CAAC,QAAQ,EAAEQ,QAAQ,CAAC;gBAC/BT,OAAO,CAACC,GAAG,CAAC,OAAO,EAAEQ,QAAQ,aAARA,QAAQ,uBAARA,QAAQ,CAAEiE,MAAM,CAAC;gBACtC9G,mBAAmB,CAAC6C,QAAQ,CAAC;gBAC7BpC,QAAQ,CAAC,kBAAkB,EAAEmB,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAC;gBAC5C;gBACA;gBACA,MAAM8F,mBAAmB,GAAGlI,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAET,gBAAgB,CAAC,CAAC;gBACvD,IAAI,CAACS,OAAO,IAAKkI,mBAAmB,KAAKnF,CAAC,CAACC,MAAM,CAACZ,KAAM,EAAE;kBACxDf,sBAAsB,CAAC,CAAC,CAAC,CAAC;gBAC5B;cACF,CAAE;cACFmB,SAAS,EAAC,wGAAwG;cAAAD,QAAA,gBAElH/D,OAAA;gBAAQ4D,KAAK,EAAC,EAAE;gBAAAG,QAAA,EAAC;cAAO;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,EAChC7B,iBAAiB,CAACmH,GAAG,CAAEnE,QAAQ,iBAC9BxF,OAAA;gBAAoC4D,KAAK,EAAE4B,QAAQ,CAACE,YAAa;gBAAA3B,QAAA,EAC9DyB,QAAQ,CAACG;cAAY,GADXH,QAAQ,CAACE,YAAY;gBAAAxB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAE1B,CACT,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACI,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CACN,eAGDrE,OAAA;YAAKgE,SAAS,EAAC,4BAA4B;YAAAD,QAAA,GAAC,iCACrB,EAACrB,gBAAgB,GAAG,GAAG,GAAG,GAAG,EAAC,WAC5C,EAACA,gBAAgB,aAAhBA,gBAAgB,eAAhBA,gBAAgB,CAAE+G,MAAM,GAAG/G,gBAAgB,CAAC+G,MAAM,CAACnE,MAAM,GAAG,CAAC,EAAC,oBACxE;UAAA;YAAApB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAK,CAAC,EACL3B,gBAAgB,IAAIA,gBAAgB,CAAC+G,MAAM,IAAI/G,gBAAgB,CAAC+G,MAAM,CAACnE,MAAM,GAAG,CAAC,iBAChFtF,OAAA;YAAKgE,SAAS,EAAC,2BAA2B;YAAAD,QAAA,gBACxC/D,OAAA;cAAIgE,SAAS,EAAC,wCAAwC;cAAAD,QAAA,EAAC;YAAM;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAI,CAAC,eAClErE,OAAA;cAAKgE,SAAS,EAAC,WAAW;cAAAD,QAAA,EACvBrB,gBAAgB,CAAC+G,MAAM,CAACE,GAAG,CAAEnG,KAAU,IAAK;gBAC3CuB,OAAO,CAACC,GAAG,CAAC,OAAO,EAAExB,KAAK,CAAC;gBAC3B,OAAOD,mBAAmB,CAACC,KAAK,CAAC;cACnC,CAAC;YAAC;cAAAU,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CACN,eAGDrE,OAAA;YAAKgE,SAAS,EAAC,wBAAwB;YAAAD,QAAA,gBACrC/D,OAAA;cAAA+D,QAAA,gBACE/D,OAAA;gBAAOgE,SAAS,EAAC,8CAA8C;gBAAAD,QAAA,EAAC;cAEhE;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACRrE,OAAA;gBACE8D,IAAI,EAAC,QAAQ;gBACb8F,IAAI,EAAC,MAAM;gBAAA,GACP9G,QAAQ,CAAC,OAAO,EAAE;kBAAE+G,aAAa,EAAE;gBAAK,CAAC,CAAC;gBAC9C7F,SAAS,EAAE,0FACTf,MAAM,CAACzC,KAAK,GAAG,gBAAgB,GAAG,iBAAiB,EAClD;gBACHiE,WAAW,EAAC;cAAM;gBAAAP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACnB,CAAC,EACDpB,MAAM,CAACzC,KAAK,iBACXR,OAAA;gBAAGgE,SAAS,EAAC,2BAA2B;gBAAAD,QAAA,EAAEd,MAAM,CAACzC,KAAK,CAAC4I;cAAO;gBAAAlF,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CACnE;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC,eAENrE,OAAA;cAAA+D,QAAA,gBACE/D,OAAA;gBAAOgE,SAAS,EAAC,8CAA8C;gBAAAD,QAAA,EAAC;cAEhE;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACRrE,OAAA;gBACE8D,IAAI,EAAC,QAAQ;gBAAA,GACThB,QAAQ,CAAC,OAAO,EAAE;kBAAE+G,aAAa,EAAE;gBAAK,CAAC,CAAC;gBAC9C7F,SAAS,EAAE,0FACTf,MAAM,CAACtC,KAAK,GAAG,gBAAgB,GAAG,iBAAiB,EAClD;gBACH8D,WAAW,EAAC;cAAG;gBAAAP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAChB,CAAC,EACDpB,MAAM,CAACtC,KAAK,iBACXX,OAAA;gBAAGgE,SAAS,EAAC,2BAA2B;gBAAAD,QAAA,EAAEd,MAAM,CAACtC,KAAK,CAACyI;cAAO;gBAAAlF,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CACnE;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACE,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGNrE,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,EAGPjC,cAAc,CAACkD,MAAM,GAAG,CAAC,iBACxBtF,OAAA;cAAA+D,QAAA,gBACE/D,OAAA;gBAAOgE,SAAS,EAAC,8CAA8C;gBAAAD,QAAA,GAAC,4BACxD,EAAC3B,cAAc,CAACkD,MAAM,EAAC,SAC/B;cAAA;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACRrE,OAAA;gBAAKgE,SAAS,EAAC,6BAA6B;gBAAAD,QAAA,EACzC3B,cAAc,CAACuH,GAAG,CAAC,CAACX,KAAK,EAAEvD,KAAK,KAAK;kBAEpC,oBACEzF,OAAA;oBAAiBgE,SAAS,EAAC,gBAAgB;oBAAAD,QAAA,gBACzC/D,OAAA;sBACE8J,GAAG,EAAE,GAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,IAAI,uBAAuB,GAAGjB,KAAK,EAAG;sBAC3EkB,GAAG,EAAE,QAAQzE,KAAK,GAAG,CAAC,EAAG;sBACzBzB,SAAS,EAAC;oBAA4D;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OACvE,CAAC,eACFrE,OAAA;sBACE8D,IAAI,EAAC,QAAQ;sBACbyF,OAAO,EAAEA,CAAA,KAAM;wBACblH,iBAAiB,CAACwB,IAAI,IAAIA,IAAI,CAACwD,MAAM,CAAC,CAACY,CAAC,EAAEC,CAAC,KAAKA,CAAC,KAAKzC,KAAK,CAAC,CAAC;wBAC7DlD,iBAAiB,CAACsB,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAEmF,KAAK,CAAC,CAAC;sBAC7C,CAAE;sBACFhF,SAAS,EAAC,6HAA6H;sBAAAD,QAAA,EACxI;oBAED;sBAAAG,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC;kBAAA,GAfDoB,KAAK;oBAAAvB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAgBV,CAAC;gBAEV,CAAC;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN,EAGCrC,MAAM,CAACsD,MAAM,GAAGlD,cAAc,CAACkD,MAAM,GAAI,CAAC,iBAC1CtF,OAAA;cAAA+D,QAAA,gBACE/D,OAAA;gBAAOgE,SAAS,EAAC,8CAA8C;gBAAAD,QAAA,EAC5D3B,cAAc,CAACkD,MAAM,GAAG,CAAC,GAAG,MAAM,GAAG;cAAM;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACvC,CAAC,eACRrE,OAAA;gBAAKgE,SAAS,EAAC,2GAA2G;gBAAAD,QAAA,gBACxH/D,OAAA;kBACE8D,IAAI,EAAC,MAAM;kBACXqG,QAAQ;kBACRC,MAAM,EAAC,SAAS;kBAChB9F,QAAQ,EAAEiD,iBAAkB;kBAC5BvD,SAAS,EAAC,QAAQ;kBAClBqG,EAAE,EAAC;gBAAc;kBAAAnG,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAClB,CAAC,eACFrE,OAAA;kBACEsK,OAAO,EAAC,cAAc;kBACtBtG,SAAS,EAAC,2CAA2C;kBAAAD,QAAA,gBAErD/D,OAAA,CAACN,SAAS;oBAACsE,SAAS,EAAC;kBAA8B;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE,CAAC,eACtDrE,OAAA;oBAAMgE,SAAS,EAAC,uBAAuB;oBAAAD,QAAA,EAAC;kBAExC;oBAAAG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC,eACPrE,OAAA;oBAAMgE,SAAS,EAAC,4BAA4B;oBAAAD,QAAA,GAAC,2DAC1B,EAAC,CAAC,GAAG/B,MAAM,CAACsD,MAAM,GAAGlD,cAAc,CAACkD,MAAM,EAAC,SAC9D;kBAAA;oBAAApB,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAM,CAAC;gBAAA;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACF,CAAC;cAAA;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN,EAGAnC,gBAAgB,CAACoD,MAAM,GAAG,CAAC,iBAC1BtF,OAAA;cAAA+D,QAAA,gBACE/D,OAAA;gBAAOgE,SAAS,EAAC,8CAA8C;gBAAAD,QAAA,GAAC,kCACvD,EAAC7B,gBAAgB,CAACoD,MAAM,EAAC,SAClC;cAAA;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eACRrE,OAAA;gBAAKgE,SAAS,EAAC,wBAAwB;gBAAAD,QAAA,EACpC7B,gBAAgB,CAACyH,GAAG,CAAC,CAACY,GAAG,EAAE9E,KAAK,kBAC/BzF,OAAA;kBAAiBgE,SAAS,EAAC,gBAAgB;kBAAAD,QAAA,gBACzC/D,OAAA;oBACE8J,GAAG,EAAES,GAAI;oBACTL,GAAG,EAAE,OAAOzE,KAAK,GAAG,CAAC,EAAG;oBACxBzB,SAAS,EAAC;kBAA4D;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACvE,CAAC,eACFrE,OAAA;oBACE8D,IAAI,EAAC,QAAQ;oBACbyF,OAAO,EAAEA,CAAA,KAAMvB,cAAc,CAACvC,KAAK,CAAE;oBACrCzB,SAAS,EAAC,6HAA6H;oBAAAD,QAAA,EACxI;kBAED;oBAAAG,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAQ,CAAC;gBAAA,GAZDoB,KAAK;kBAAAvB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAaV,CACN;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACC,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACH,CACN;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACE,CAAC,MAAE,eAGRrE,OAAA;YAAA+D,QAAA,gBACE/D,OAAA;cAAOgE,SAAS,EAAC,8CAA8C;cAAAD,QAAA,EAAC;YAEhE;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAO,CAAC,eACRrE,OAAA;cAAKgE,SAAS,EAAC,2BAA2B;cAAAD,QAAA,EACvC7C,IAAI,CAACyI,GAAG,CAAC,CAACrC,GAAG,EAAE7B,KAAK,kBACnBzF,OAAA;gBAEEgE,SAAS,EAAC,+FAA+F;gBAAAD,QAAA,GAExGuD,GAAG,eACJtH,OAAA;kBACE8D,IAAI,EAAC,QAAQ;kBACbyF,OAAO,EAAEA,CAAA,KAAMpC,eAAe,CAACG,GAAG,CAAE;kBACpCtD,SAAS,EAAC,wCAAwC;kBAAAD,QAAA,eAElD/D,OAAA,CAACL,SAAS;oBAACqE,SAAS,EAAC;kBAAS;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAE;gBAAC;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAC3B,CAAC;cAAA,GAVJoB,KAAK;gBAAAvB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAWN,CACP;YAAC;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACC,CAAC,eACNrE,OAAA;cAAKgE,SAAS,EAAC,YAAY;cAAAD,QAAA,gBACzB/D,OAAA;gBACE8D,IAAI,EAAC,MAAM;gBACXF,KAAK,EAAE9B,QAAS;gBAChBwC,QAAQ,EAAGC,CAAC,IAAKxC,WAAW,CAACwC,CAAC,CAACC,MAAM,CAACZ,KAAK,CAAE;gBAC7C4G,UAAU,EAAGjG,CAAC,IAAKA,CAAC,CAACmE,GAAG,KAAK,OAAO,KAAKnE,CAAC,CAACkG,cAAc,CAAC,CAAC,EAAE1D,YAAY,CAAC,CAAC,CAAE;gBAC7E/C,SAAS,EAAC,wGAAwG;gBAClHS,WAAW,EAAC;cAAY;gBAAAP,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACzB,CAAC,eACFrE,OAAA;gBACE8D,IAAI,EAAC,QAAQ;gBACbyF,OAAO,EAAExC,YAAa;gBACtB/C,SAAS,EAAC,+DAA+D;gBAAAD,QAAA,EAC1E;cAED;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACN,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACH,CAAC,eAGNrE,OAAA;YAAKgE,SAAS,EAAC,iCAAiC;YAAAD,QAAA,gBAC9C/D,OAAA;cACE8D,IAAI,EAAC,QAAQ;cACbyF,OAAO,EAAEhI,OAAQ;cACjByC,SAAS,EAAC,4EAA4E;cAAAD,QAAA,EACvF;YAED;cAAAG,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC,eACTrE,OAAA;cACE8D,IAAI,EAAC,QAAQ;cACb4G,QAAQ,EAAE/I,OAAQ;cAClBqC,SAAS,EAAC,mFAAmF;cAAAD,QAAA,EAE5FpC,OAAO,GAAG,QAAQ,GAAG;YAAI;cAAAuC,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACpB,CAAC;UAAA;YAAAH,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACF,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACJ,CAAC,MAAE;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC;AAAC3C,EAAA,CApsBIL,YAAyC;EAAA,QAmBzC/B,OAAO;AAAA;AAAAqL,EAAA,GAnBPtJ,YAAyC;AAssB/C,eAAeA,YAAY;AAAC,IAAAsJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}