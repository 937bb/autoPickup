{"ast":null,"code":"var _jsxFileName = \"/Users/937bb/Documents/userProject/AutoPickup/admin-panel/src/components/ProductModal.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useForm } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport toast from 'react-hot-toast';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { productAPI, dictionaryAPI } from '../services/api';\nimport DictionarySelect from './DictionarySelect';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst schema = yup.object({\n  name: yup.string().required('请输入商品名称'),\n  description: yup.string().required('请输入商品描述'),\n  category: yup.string().required('请选择商品分类'),\n  price: yup.number().positive('价格必须大于0').required('请输入价格'),\n  stock: yup.number().integer('库存必须是整数').min(0, '库存不能小于0').required('请输入库存'),\n  deliveryType: yup.string().required('请选择发货类型'),\n  deliveryTemplate: yup.string().optional(),\n  deliveryData: yup.object().optional(),\n  // 添加发货数据字段\n  tags: yup.array().of(yup.string())\n});\nconst ProductModal = ({\n  isOpen,\n  onClose,\n  product,\n  onSave\n}) => {\n  _s();\n  const [loading, setLoading] = useState(false);\n  const [tags, setTags] = useState([]);\n  const [tagInput, setTagInput] = useState('');\n  const [images, setImages] = useState([]);\n  const [imagePreviewUrls, setImagePreviewUrls] = useState([]);\n  const [existingImages, setExistingImages] = useState([]);\n  const [imagesToRemove, setImagesToRemove] = useState([]);\n  const [deliveryTemplates, setDeliveryTemplates] = useState([]);\n  const [selectedTemplate, setSelectedTemplate] = useState(null);\n  const [templateFieldValues, setTemplateFieldValues] = useState({});\n  const {\n    register,\n    handleSubmit,\n    formState: {\n      errors\n    },\n    reset,\n    watch,\n    setValue\n  } = useForm({\n    resolver: yupResolver(schema),\n    defaultValues: {\n      name: '',\n      description: '',\n      category: '',\n      price: 0,\n      stock: 0,\n      deliveryType: '',\n      deliveryTemplate: '',\n      tags: []\n    }\n  });\n  const deliveryType = watch('deliveryType');\n\n  // 获取发货模板\n  const fetchDeliveryTemplates = async deliveryType => {\n    try {\n      const response = await dictionaryAPI.getDeliveryTemplates(deliveryType);\n      if (response.data.success) {\n        setDeliveryTemplates(response.data.data);\n        const defaultTemplate = response.data.data.find(t => t.isDefault);\n        if (defaultTemplate) {\n          setSelectedTemplate(defaultTemplate);\n          setValue('deliveryTemplate', defaultTemplate.templateCode);\n        }\n      }\n    } catch (error) {\n      console.error('获取发货模板失败:', error);\n    }\n  };\n\n  // 处理发货类型变化\n  const handleDeliveryTypeChange = (value, option) => {\n    setValue('deliveryType', value);\n    if (option) {\n      fetchDeliveryTemplates(option.value);\n    }\n  };\n  useEffect(() => {\n    if (product) {\n      reset({\n        name: product.name,\n        description: product.description,\n        category: product.category || '',\n        price: product.price,\n        stock: product.stock,\n        deliveryType: product.deliveryType || '',\n        deliveryTemplate: product.deliveryTemplate || '',\n        tags: product.tags || []\n      });\n      setTags(product.tags || []);\n      setExistingImages(product.images || []);\n\n      // 如果产品有发货数据，设置模板字段值\n      if (product.deliveryData) {\n        setTemplateFieldValues(product.deliveryData);\n      }\n\n      // 如果有发货类型，获取对应的模板\n      if (product.deliveryType) {\n        fetchDeliveryTemplates(product.deliveryType);\n      }\n    } else {\n      reset({\n        name: '',\n        description: '',\n        category: '',\n        price: 0,\n        stock: 0,\n        deliveryType: '',\n        deliveryTemplate: '',\n        tags: []\n      });\n      setTags([]);\n      setExistingImages([]);\n      setTemplateFieldValues({});\n      setSelectedTemplate(null);\n    }\n  }, [product, reset]);\n  const handleAddTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      const newTags = [...tags, tagInput.trim()];\n      setTags(newTags);\n      setValue('tags', newTags);\n      setTagInput('');\n    }\n  };\n  const handleRemoveTag = tagToRemove => {\n    const newTags = tags.filter(tag => tag !== tagToRemove);\n    setTags(newTags);\n    setValue('tags', newTags);\n  };\n  const handleImageUpload = e => {\n    const files = Array.from(e.target.files || []);\n    const totalImages = images.length + existingImages.length;\n    if (totalImages + files.length > 5) {\n      toast.error('最多只能上传5张图片');\n      return;\n    }\n    setImages(prev => [...prev, ...files]);\n    files.forEach(file => {\n      const reader = new FileReader();\n      reader.onload = e => {\n        setImagePreviewUrls(prev => {\n          var _e$target;\n          return [...prev, (_e$target = e.target) === null || _e$target === void 0 ? void 0 : _e$target.result];\n        });\n      };\n      reader.readAsDataURL(file);\n    });\n  };\n  const removeNewImage = index => {\n    setImages(prev => prev.filter((_, i) => i !== index));\n    setImagePreviewUrls(prev => prev.filter((_, i) => i !== index));\n  };\n  const removeExistingImage = index => {\n    const imageToRemove = existingImages[index];\n    setImagesToRemove(prev => [...prev, imageToRemove]);\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\n  };\n  const onSubmit = async data => {\n    try {\n      setLoading(true);\n      const formData = new FormData();\n\n      // 添加基本字段\n      Object.keys(data).forEach(key => {\n        if (key !== 'tags' && data[key] !== undefined) {\n          formData.append(key, String(data[key]));\n        }\n      });\n\n      // 添加标签\n      if (tags.length > 0) {\n        formData.append('tags', JSON.stringify(tags));\n      }\n\n      // 添加模板字段数据\n      if (selectedTemplate && Object.keys(templateFieldValues).length > 0) {\n        formData.append('deliveryData', JSON.stringify(templateFieldValues));\n      }\n\n      // 添加图片\n      images.forEach(image => {\n        formData.append('images', image);\n      });\n\n      // 添加要删除的图片\n      if (imagesToRemove.length > 0) {\n        formData.append('imagesToRemove', JSON.stringify(imagesToRemove));\n      }\n      let response;\n      if (product) {\n        response = await productAPI.updateProduct(product._id, formData);\n      } else {\n        response = await productAPI.createProduct(formData);\n      }\n      if (response.success) {\n        toast.success(product ? '商品更新成功' : '商品创建成功');\n        onSave();\n        onClose();\n      } else {\n        toast.error(response.message || '操作失败');\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('提交失败:', error);\n      toast.error(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || '操作失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n  if (!isOpen) return null;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 shadow-lg rounded-md bg-white\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex justify-between items-center mb-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"text-lg font-medium text-gray-900\",\n            children: product ? '编辑商品' : '添加商品'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onClose,\n            className: \"text-gray-400 hover:text-gray-600\",\n            children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n              className: \"w-6 h-6\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit(onSubmit),\n          className: \"space-y-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u540D\\u79F0 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 256,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              ...register('name'),\n              className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.name ? 'border-red-500' : 'border-gray-300'}`,\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5546\\u54C1\\u540D\\u79F0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this), errors.name && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.name.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u63CF\\u8FF0 *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              ...register('description'),\n              rows: 4,\n              className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.description ? 'border-red-500' : 'border-gray-300'}`,\n              placeholder: \"\\u8BF7\\u8F93\\u5165\\u5546\\u54C1\\u63CF\\u8FF0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 277,\n              columnNumber: 15\n            }, this), errors.description && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.description.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 286,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u5206\\u7C7B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 292,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(DictionarySelect, {\n              typeCode: \"PRODUCT_CATEGORY\",\n              value: watch('category'),\n              onChange: value => setValue('category', value),\n              placeholder: \"\\u8BF7\\u9009\\u62E9\\u5546\\u54C1\\u5206\\u7C7B\",\n              className: errors.category ? 'border-red-500' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 15\n            }, this), errors.category && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.category.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 291,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u53D1\\u8D27\\u7C7B\\u578B *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(DictionarySelect, {\n              typeCode: \"DELIVERY_TYPE\",\n              value: watch('deliveryType'),\n              onChange: handleDeliveryTypeChange,\n              placeholder: \"\\u8BF7\\u9009\\u62E9\\u53D1\\u8D27\\u7C7B\\u578B\",\n              className: errors.deliveryType ? 'border-red-500' : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 312,\n              columnNumber: 15\n            }, this), errors.deliveryType && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"text-red-500 text-sm mt-1\",\n              children: errors.deliveryType.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 320,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), deliveryTemplates.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u53D1\\u8D27\\u6A21\\u677F\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              value: (selectedTemplate === null || selectedTemplate === void 0 ? void 0 : selectedTemplate.templateCode) || '',\n              onChange: e => {\n                const template = deliveryTemplates.find(t => t.templateCode === e.target.value);\n                setSelectedTemplate(template);\n                setValue('deliveryTemplate', e.target.value);\n                // 重置模板字段值\n                setTemplateFieldValues({});\n              },\n              className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\u8BF7\\u9009\\u62E9\\u53D1\\u8D27\\u6A21\\u677F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 19\n              }, this), deliveryTemplates.map(template => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: template.templateCode,\n                children: template.templateName\n              }, template.templateCode, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 15\n          }, this), selectedTemplate && selectedTemplate.fields && selectedTemplate.fields.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bg-gray-50 rounded-lg p-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              className: \"text-sm font-medium text-gray-700 mb-3\",\n              children: \"\\u53D1\\u8D27\\u4FE1\\u606F\\u586B\\u5199\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 354,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"space-y-4\",\n              children: selectedTemplate.fields.map(field => renderTemplateField(field))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 353,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-2 gap-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"\\u4EF7\\u683C *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                step: \"0.01\",\n                ...register('price', {\n                  valueAsNumber: true\n                }),\n                className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.price ? 'border-red-500' : 'border-gray-300'}`,\n                placeholder: \"0.00\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 367,\n                columnNumber: 17\n              }, this), errors.price && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-red-500 text-sm mt-1\",\n                children: errors.price.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 363,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"block text-sm font-medium text-gray-700 mb-1\",\n                children: \"\\u5E93\\u5B58 *\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                ...register('stock', {\n                  valueAsNumber: true\n                }),\n                className: `w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${errors.stock ? 'border-red-500' : 'border-gray-300'}`,\n                placeholder: \"0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 17\n              }, this), errors.stock && /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"text-red-500 text-sm mt-1\",\n                children: errors.stock.message\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 394,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 381,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 362,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-2\",\n              children: \"\\u5546\\u54C1\\u56FE\\u7247 (\\u6700\\u591A5\\u5F20)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 401,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4\",\n              children: [existingImages.map((imageUrl, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative group\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: imageUrl,\n                  alt: `商品图片 ${index + 1}`,\n                  className: \"w-full h-24 object-cover rounded-lg border border-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 408,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => removeExistingImage(index),\n                  className: \"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\",\n                  children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 418,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 413,\n                  columnNumber: 21\n                }, this)]\n              }, `existing-${index}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 407,\n                columnNumber: 19\n              }, this)), imagePreviewUrls.map((url, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"relative group\",\n                children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                  src: url,\n                  alt: `新图片 ${index + 1}`,\n                  className: \"w-full h-24 object-cover rounded-lg border border-gray-300\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 425,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => removeNewImage(index),\n                  className: \"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\",\n                  children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n                    className: \"w-4 h-4\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 435,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 430,\n                  columnNumber: 21\n                }, this)]\n              }, `new-${index}`, true, {\n                fileName: _jsxFileName,\n                lineNumber: 424,\n                columnNumber: 19\n              }, this)), images.length + existingImages.length < 5 && /*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"flex flex-col items-center justify-center w-full h-24 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"flex flex-col items-center justify-center pt-2 pb-2\",\n                  children: [/*#__PURE__*/_jsxDEV(PhotoIcon, {\n                    className: \"w-6 h-6 text-gray-400 mb-1\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 443,\n                    columnNumber: 23\n                  }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                    className: \"text-xs text-gray-500\",\n                    children: \"\\u6DFB\\u52A0\\u56FE\\u7247\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 444,\n                    columnNumber: 23\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 442,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"file\",\n                  multiple: true,\n                  accept: \"image/*\",\n                  onChange: handleImageUpload,\n                  className: \"hidden\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 446,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 441,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 405,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 400,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              className: \"block text-sm font-medium text-gray-700 mb-1\",\n              children: \"\\u5546\\u54C1\\u6807\\u7B7E\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex flex-wrap gap-2 mb-2\",\n              children: tags.map((tag, index) => /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\",\n                children: [tag, /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"button\",\n                  onClick: () => handleRemoveTag(tag),\n                  className: \"ml-1 text-blue-600 hover:text-blue-800\",\n                  children: /*#__PURE__*/_jsxDEV(XMarkIcon, {\n                    className: \"w-3 h-3\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 475,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 470,\n                  columnNumber: 21\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 465,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex gap-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"text\",\n                value: tagInput,\n                onChange: e => setTagInput(e.target.value),\n                onKeyPress: e => e.key === 'Enter' && (e.preventDefault(), handleAddTag()),\n                className: \"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\",\n                placeholder: \"\\u8F93\\u5165\\u6807\\u7B7E\\u540E\\u6309\\u56DE\\u8F66\\u6DFB\\u52A0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                onClick: handleAddTag,\n                className: \"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\",\n                children: \"\\u6DFB\\u52A0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 480,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex justify-end space-x-2 pt-4\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: onClose,\n              className: \"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50\",\n              children: \"\\u53D6\\u6D88\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 501,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: loading,\n              className: \"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\",\n              children: loading ? '保存中...' : '保存'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 508,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 500,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 5\n  }, this);\n};\n_s(ProductModal, \"epWB0xTq8d6URhnmUcUsJ8lDXgg=\", false, function () {\n  return [useForm];\n});\n_c = ProductModal;\nexport default ProductModal;\n\n// 渲染模板字段的函数\nconst renderTemplateField = field => {\n  const fieldValue = templateFieldValues[field.name] || field.defaultValue || '';\n  const updateFieldValue = value => {\n    setTemplateFieldValues(prev => ({\n      ...prev,\n      [field.name]: value\n    }));\n  };\n  switch (field.type) {\n    case 'text':\n    case 'url':\n    case 'number':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: [field.label, \" \", field.required && '*']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: field.type === 'number' ? 'number' : 'text',\n          value: fieldValue,\n          onChange: e => updateFieldValue(e.target.value),\n          placeholder: field.placeholder,\n          required: field.required,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 11\n        }, this)]\n      }, field.name, true, {\n        fileName: _jsxFileName,\n        lineNumber: 541,\n        columnNumber: 9\n      }, this);\n    case 'password':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: [field.label, \" \", field.required && '*']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          value: fieldValue,\n          onChange: e => updateFieldValue(e.target.value),\n          placeholder: field.placeholder,\n          required: field.required,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 11\n        }, this)]\n      }, field.name, true, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 9\n      }, this);\n    case 'textarea':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: [field.label, \" \", field.required && '*']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 576,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: fieldValue,\n          onChange: e => updateFieldValue(e.target.value),\n          placeholder: field.placeholder,\n          required: field.required,\n          rows: 3,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 11\n        }, this)]\n      }, field.name, true, {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 9\n      }, this);\n    case 'file':\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700 mb-1\",\n          children: [field.label, \" \", field.required && '*']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          onChange: e => {\n            var _e$target$files;\n            const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n            if (file) {\n              updateFieldValue(file.name);\n            }\n          },\n          required: field.required,\n          className: \"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 596,\n          columnNumber: 11\n        }, this)]\n      }, field.name, true, {\n        fileName: _jsxFileName,\n        lineNumber: 592,\n        columnNumber: 9\n      }, this);\n    default:\n      return null;\n  }\n};\nvar _c;\n$RefreshReg$(_c, \"ProductModal\");","map":{"version":3,"names":["React","useState","useEffect","useForm","yupResolver","yup","toast","PhotoIcon","XMarkIcon","productAPI","dictionaryAPI","DictionarySelect","jsxDEV","_jsxDEV","schema","object","name","string","required","description","category","price","number","positive","stock","integer","min","deliveryType","deliveryTemplate","optional","deliveryData","tags","array","of","ProductModal","isOpen","onClose","product","onSave","_s","loading","setLoading","setTags","tagInput","setTagInput","images","setImages","imagePreviewUrls","setImagePreviewUrls","existingImages","setExistingImages","imagesToRemove","setImagesToRemove","deliveryTemplates","setDeliveryTemplates","selectedTemplate","setSelectedTemplate","templateFieldValues","setTemplateFieldValues","register","handleSubmit","formState","errors","reset","watch","setValue","resolver","defaultValues","fetchDeliveryTemplates","response","getDeliveryTemplates","data","success","defaultTemplate","find","t","isDefault","templateCode","error","console","handleDeliveryTypeChange","value","option","handleAddTag","trim","includes","newTags","handleRemoveTag","tagToRemove","filter","tag","handleImageUpload","e","files","Array","from","target","totalImages","length","prev","forEach","file","reader","FileReader","onload","_e$target","result","readAsDataURL","removeNewImage","index","_","i","removeExistingImage","imageToRemove","onSubmit","formData","FormData","Object","keys","key","undefined","append","String","JSON","stringify","image","updateProduct","_id","createProduct","message","_error$response","_error$response$data","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","type","placeholder","rows","typeCode","onChange","template","map","templateName","fields","field","renderTemplateField","step","valueAsNumber","imageUrl","src","alt","url","multiple","accept","onKeyPress","preventDefault","disabled","_c","fieldValue","defaultValue","updateFieldValue","label","_e$target$files","$RefreshReg$"],"sources":["/Users/937bb/Documents/userProject/AutoPickup/admin-panel/src/components/ProductModal.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useForm, SubmitHandler } from 'react-hook-form';\nimport { yupResolver } from '@hookform/resolvers/yup';\nimport * as yup from 'yup';\nimport toast from 'react-hot-toast';\nimport { PhotoIcon, XMarkIcon } from '@heroicons/react/24/outline';\nimport { productAPI, dictionaryAPI } from '../services/api';\nimport { Product, ProductFormData } from '../types';\nimport DictionarySelect from './DictionarySelect';\n\nconst schema = yup.object({\n  name: yup.string().required('请输入商品名称'),\n  description: yup.string().required('请输入商品描述'),\n  category: yup.string().required('请选择商品分类'),\n  price: yup.number().positive('价格必须大于0').required('请输入价格'),\n  stock: yup.number().integer('库存必须是整数').min(0, '库存不能小于0').required('请输入库存'),\n  deliveryType: yup.string().required('请选择发货类型'),\n  deliveryTemplate: yup.string().optional(),\n  deliveryData: yup.object().optional(), // 添加发货数据字段\n  tags: yup.array().of(yup.string()),\n});\n\ntype FormData = yup.InferType<typeof schema>;\n\ninterface ProductModalProps {\n  isOpen: boolean;\n  product?: Product | null;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nconst ProductModal: React.FC<ProductModalProps> = ({ isOpen, onClose, product, onSave }) => {\n  const [loading, setLoading] = useState(false);\n  const [tags, setTags] = useState<string[]>([]);\n  const [tagInput, setTagInput] = useState('');\n  const [images, setImages] = useState<File[]>([]);\n  const [imagePreviewUrls, setImagePreviewUrls] = useState<string[]>([]);\n  const [existingImages, setExistingImages] = useState<string[]>([]);\n  const [imagesToRemove, setImagesToRemove] = useState<string[]>([]);\n  const [deliveryTemplates, setDeliveryTemplates] = useState<any[]>([]);\n  const [selectedTemplate, setSelectedTemplate] = useState<any>(null);\n  const [templateFieldValues, setTemplateFieldValues] = useState<Record<string, any>>({});\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    reset,\n    watch,\n    setValue,\n  } = useForm<FormData>({\n    resolver: yupResolver(schema),\n    defaultValues: {\n      name: '',\n      description: '',\n      category: '',\n      price: 0,\n      stock: 0,\n      deliveryType: '',\n      deliveryTemplate: '',\n      tags: [],\n    },\n  });\n\n  const deliveryType = watch('deliveryType');\n\n  // 获取发货模板\n  const fetchDeliveryTemplates = async (deliveryType: string) => {\n    try {\n      const response = await dictionaryAPI.getDeliveryTemplates(deliveryType);\n      if (response.data.success) {\n        setDeliveryTemplates(response.data.data);\n        const defaultTemplate = response.data.data.find((t: any) => t.isDefault);\n        if (defaultTemplate) {\n          setSelectedTemplate(defaultTemplate);\n          setValue('deliveryTemplate', defaultTemplate.templateCode);\n        }\n      }\n    } catch (error) {\n      console.error('获取发货模板失败:', error);\n    }\n  };\n\n  // 处理发货类型变化\n  const handleDeliveryTypeChange = (value: string, option?: any) => {\n    setValue('deliveryType', value);\n    if (option) {\n      fetchDeliveryTemplates(option.value);\n    }\n  };\n\n  useEffect(() => {\n    if (product) {\n      reset({\n        name: product.name,\n        description: product.description,\n        category: product.category || '',\n        price: product.price,\n        stock: product.stock,\n        deliveryType: product.deliveryType || '',\n        deliveryTemplate: product.deliveryTemplate || '',\n        tags: product.tags || [],\n      });\n      setTags(product.tags || []);\n      setExistingImages(product.images || []);\n      \n      // 如果产品有发货数据，设置模板字段值\n      if (product.deliveryData) {\n        setTemplateFieldValues(product.deliveryData);\n      }\n      \n      // 如果有发货类型，获取对应的模板\n      if (product.deliveryType) {\n        fetchDeliveryTemplates(product.deliveryType);\n      }\n    } else {\n      reset({\n        name: '',\n        description: '',\n        category: '',\n        price: 0,\n        stock: 0,\n        deliveryType: '',\n        deliveryTemplate: '',\n        tags: [],\n      });\n      setTags([]);\n      setExistingImages([]);\n      setTemplateFieldValues({});\n      setSelectedTemplate(null);\n    }\n  }, [product, reset]);\n\n  const handleAddTag = () => {\n    if (tagInput.trim() && !tags.includes(tagInput.trim())) {\n      const newTags = [...tags, tagInput.trim()];\n      setTags(newTags);\n      setValue('tags', newTags);\n      setTagInput('');\n    }\n  };\n\n  const handleRemoveTag = (tagToRemove: string) => {\n    const newTags = tags.filter(tag => tag !== tagToRemove);\n    setTags(newTags);\n    setValue('tags', newTags);\n  };\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    const totalImages = images.length + existingImages.length;\n    \n    if (totalImages + files.length > 5) {\n      toast.error('最多只能上传5张图片');\n      return;\n    }\n\n    setImages(prev => [...prev, ...files]);\n    \n    files.forEach(file => {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        setImagePreviewUrls(prev => [...prev, e.target?.result as string]);\n      };\n      reader.readAsDataURL(file);\n    });\n  };\n\n  const removeNewImage = (index: number) => {\n    setImages(prev => prev.filter((_, i) => i !== index));\n    setImagePreviewUrls(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const removeExistingImage = (index: number) => {\n    const imageToRemove = existingImages[index];\n    setImagesToRemove(prev => [...prev, imageToRemove]);\n    setExistingImages(prev => prev.filter((_, i) => i !== index));\n  };\n\n  const onSubmit: SubmitHandler<FormData> = async (data) => {\n    try {\n      setLoading(true);\n      \n      const formData = new FormData();\n      \n      // 添加基本字段\n      Object.keys(data).forEach(key => {\n        if (key !== 'tags' && data[key as keyof FormData] !== undefined) {\n          formData.append(key, String(data[key as keyof FormData]));\n        }\n      });\n      \n      // 添加标签\n      if (tags.length > 0) {\n        formData.append('tags', JSON.stringify(tags));\n      }\n      \n      // 添加模板字段数据\n      if (selectedTemplate && Object.keys(templateFieldValues).length > 0) {\n        formData.append('deliveryData', JSON.stringify(templateFieldValues));\n      }\n      \n      // 添加图片\n      images.forEach((image) => {\n        formData.append('images', image);\n      });\n      \n      // 添加要删除的图片\n      if (imagesToRemove.length > 0) {\n        formData.append('imagesToRemove', JSON.stringify(imagesToRemove));\n      }\n      \n      let response;\n      if (product) {\n        response = await productAPI.updateProduct(product._id, formData);\n      } else {\n        response = await productAPI.createProduct(formData);\n      }\n      \n      if (response.success) {\n        toast.success(product ? '商品更新成功' : '商品创建成功');\n        onSave();\n        onClose();\n      } else {\n        toast.error(response.message || '操作失败');\n      }\n    } catch (error: any) {\n      console.error('提交失败:', error);\n      toast.error(error.response?.data?.message || '操作失败');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\n      <div className=\"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-2/3 xl:w-1/2 shadow-lg rounded-md bg-white\">\n        <div className=\"mt-3\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h3 className=\"text-lg font-medium text-gray-900\">\n              {product ? '编辑商品' : '添加商品'}\n            </h3>\n            <button\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600\"\n            >\n              <XMarkIcon className=\"w-6 h-6\" />\n            </button>\n          </div>\n\n          <form onSubmit={handleSubmit(onSubmit)} className=\"space-y-6\">\n            {/* 商品名称 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品名称 *\n              </label>\n              <input\n                type=\"text\"\n                {...register('name')}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                  errors.name ? 'border-red-500' : 'border-gray-300'\n                }`}\n                placeholder=\"请输入商品名称\"\n              />\n              {errors.name && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.name.message}</p>\n              )}\n            </div>\n\n            {/* 商品描述 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品描述 *\n              </label>\n              <textarea\n                {...register('description')}\n                rows={4}\n                className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                  errors.description ? 'border-red-500' : 'border-gray-300'\n                }`}\n                placeholder=\"请输入商品描述\"\n              />\n              {errors.description && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.description.message}</p>\n              )}\n            </div>\n\n            {/* 商品分类 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品分类 *\n              </label>\n              <DictionarySelect\n                typeCode=\"PRODUCT_CATEGORY\"\n                value={watch('category')}\n                onChange={(value) => setValue('category', value)}\n                placeholder=\"请选择商品分类\"\n                className={errors.category ? 'border-red-500' : ''}\n              />\n              {errors.category && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.category.message}</p>\n              )}\n            </div>\n\n            {/* 发货类型 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                发货类型 *\n              </label>\n              <DictionarySelect\n                typeCode=\"DELIVERY_TYPE\"\n                value={watch('deliveryType')}\n                onChange={handleDeliveryTypeChange}\n                placeholder=\"请选择发货类型\"\n                className={errors.deliveryType ? 'border-red-500' : ''}\n              />\n              {errors.deliveryType && (\n                <p className=\"text-red-500 text-sm mt-1\">{errors.deliveryType.message}</p>\n              )}\n            </div>\n\n            {/* 发货模板选择 */}\n            {deliveryTemplates.length > 0 && (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  发货模板\n                </label>\n                <select\n                  value={selectedTemplate?.templateCode || ''}\n                  onChange={(e) => {\n                    const template = deliveryTemplates.find(t => t.templateCode === e.target.value);\n                    setSelectedTemplate(template);\n                    setValue('deliveryTemplate', e.target.value);\n                    // 重置模板字段值\n                    setTemplateFieldValues({});\n                  }}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                >\n                  <option value=\"\">请选择发货模板</option>\n                  {deliveryTemplates.map((template) => (\n                    <option key={template.templateCode} value={template.templateCode}>\n                      {template.templateName}\n                    </option>\n                  ))}\n                </select>\n              </div>\n            )}\n\n            {/* 模板字段填写区域 */}\n            {selectedTemplate && selectedTemplate.fields && selectedTemplate.fields.length > 0 && (\n              <div className=\"bg-gray-50 rounded-lg p-4\">\n                <h4 className=\"text-sm font-medium text-gray-700 mb-3\">发货信息填写</h4>\n                <div className=\"space-y-4\">\n                  {selectedTemplate.fields.map((field: any) => renderTemplateField(field))}\n                </div>\n              </div>\n            )}\n\n            {/* 价格和库存 */}\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  价格 *\n                </label>\n                <input\n                  type=\"number\"\n                  step=\"0.01\"\n                  {...register('price', { valueAsNumber: true })}\n                  className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                    errors.price ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0.00\"\n                />\n                {errors.price && (\n                  <p className=\"text-red-500 text-sm mt-1\">{errors.price.message}</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  库存 *\n                </label>\n                <input\n                  type=\"number\"\n                  {...register('stock', { valueAsNumber: true })}\n                  className={`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${\n                    errors.stock ? 'border-red-500' : 'border-gray-300'\n                  }`}\n                  placeholder=\"0\"\n                />\n                {errors.stock && (\n                  <p className=\"text-red-500 text-sm mt-1\">{errors.stock.message}</p>\n                )}\n              </div>\n            </div>\n\n            {/* 商品图片 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                商品图片 (最多5张)\n              </label>\n              \n              <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-4\">\n                {existingImages.map((imageUrl, index) => (\n                  <div key={`existing-${index}`} className=\"relative group\">\n                    <img\n                      src={imageUrl}\n                      alt={`商品图片 ${index + 1}`}\n                      className=\"w-full h-24 object-cover rounded-lg border border-gray-300\"\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => removeExistingImage(index)}\n                      className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\"\n                    >\n                      <XMarkIcon className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                ))}\n                \n                {imagePreviewUrls.map((url, index) => (\n                  <div key={`new-${index}`} className=\"relative group\">\n                    <img\n                      src={url}\n                      alt={`新图片 ${index + 1}`}\n                      className=\"w-full h-24 object-cover rounded-lg border border-gray-300\"\n                    />\n                    <button\n                      type=\"button\"\n                      onClick={() => removeNewImage(index)}\n                      className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity\"\n                    >\n                      <XMarkIcon className=\"w-4 h-4\" />\n                    </button>\n                  </div>\n                ))}\n                \n                {(images.length + existingImages.length) < 5 && (\n                  <label className=\"flex flex-col items-center justify-center w-full h-24 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100\">\n                    <div className=\"flex flex-col items-center justify-center pt-2 pb-2\">\n                      <PhotoIcon className=\"w-6 h-6 text-gray-400 mb-1\" />\n                      <p className=\"text-xs text-gray-500\">添加图片</p>\n                    </div>\n                    <input\n                      type=\"file\"\n                      multiple\n                      accept=\"image/*\"\n                      onChange={handleImageUpload}\n                      className=\"hidden\"\n                    />\n                  </label>\n                )}\n              </div>\n            </div>\n\n            {/* 标签 */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                商品标签\n              </label>\n              <div className=\"flex flex-wrap gap-2 mb-2\">\n                {tags.map((tag, index) => (\n                  <span\n                    key={index}\n                    className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800\"\n                  >\n                    {tag}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveTag(tag)}\n                      className=\"ml-1 text-blue-600 hover:text-blue-800\"\n                    >\n                      <XMarkIcon className=\"w-3 h-3\" />\n                    </button>\n                  </span>\n                ))}\n              </div>\n              <div className=\"flex gap-2\">\n                <input\n                  type=\"text\"\n                  value={tagInput}\n                  onChange={(e) => setTagInput(e.target.value)}\n                  onKeyPress={(e) => e.key === 'Enter' && (e.preventDefault(), handleAddTag())}\n                  className=\"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n                  placeholder=\"输入标签后按回车添加\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={handleAddTag}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n                >\n                  添加\n                </button>\n              </div>\n            </div>\n\n            {/* 提交按钮 */}\n            <div className=\"flex justify-end space-x-2 pt-4\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50\"\n              >\n                取消\n              </button>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50\"\n              >\n                {loading ? '保存中...' : '保存'}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default ProductModal;\n\n// 渲染模板字段的函数\nconst renderTemplateField = (field: any) => {\n  const fieldValue = templateFieldValues[field.name] || field.defaultValue || '';\n  \n  const updateFieldValue = (value: any) => {\n    setTemplateFieldValues(prev => ({\n      ...prev,\n      [field.name]: value\n    }));\n  };\n\n  switch (field.type) {\n    case 'text':\n    case 'url':\n    case 'number':\n      return (\n        <div key={field.name}>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {field.label} {field.required && '*'}\n          </label>\n          <input\n            type={field.type === 'number' ? 'number' : 'text'}\n            value={fieldValue}\n            onChange={(e) => updateFieldValue(e.target.value)}\n            placeholder={field.placeholder}\n            required={field.required}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n      );\n    \n    case 'password':\n      return (\n        <div key={field.name}>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {field.label} {field.required && '*'}\n          </label>\n          <input\n            type=\"password\"\n            value={fieldValue}\n            onChange={(e) => updateFieldValue(e.target.value)}\n            placeholder={field.placeholder}\n            required={field.required}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n      );\n    \n    case 'textarea':\n      return (\n        <div key={field.name}>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {field.label} {field.required && '*'}\n          </label>\n          <textarea\n            value={fieldValue}\n            onChange={(e) => updateFieldValue(e.target.value)}\n            placeholder={field.placeholder}\n            required={field.required}\n            rows={3}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n      );\n    \n    case 'file':\n      return (\n        <div key={field.name}>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n            {field.label} {field.required && '*'}\n          </label>\n          <input\n            type=\"file\"\n            onChange={(e) => {\n              const file = e.target.files?.[0];\n              if (file) {\n                updateFieldValue(file.name);\n              }\n            }}\n            required={field.required}\n            className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500\"\n          />\n        </div>\n      );\n    \n    default:\n      return null;\n  }\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}